var LoginForm=function LoginForm(){"use strict";var e=this;e.defaultSettings={mainLoginDiv_id:"login_form",disableLoginDiv_class:"disable_login_container",usernameInput_id:"login_username",passwordInput_id:"login_password",activeSubMenu_class:"sub_menu_active",login_submit:"js-loginSubmitModal",login_modal:"login_modal"},e.init=function(a){e.params=$.extend(!0,e.defaultSettings,a),e.add_listeners(),e.recaptchaEnable=e.isRecaptchaEnable()},e.add_listeners=function(){$(".login_form_X").click((function(){e.params.disableLogin?$("."+e.params.disableLoginDiv_class).slideUp():$("#"+e.params.mainLoginDiv_id).slideUp(),e.resetErrorMessages(),$('input[name="username"]').val(""),$('input[name="password"]').val("")})),$("#js_loginform").on("submit",(function(a){a.preventDefault(),a.stopImmediatePropagation(),e.submitLogin()})),$(".login_rt_premium_btn").click((function(){e.openOauthDialog("/rtplogin")})),$(".js_pornhub_login").click((function(){e.openOauthDialog("/phlogin")})),$("#signup_link_in_modal").on("click",(function(){"library"==$("."+e.params.login_submit).data("ga-entry")&&ga("send","event",{eventLabel:"mobile"==page_params.global.platform?"mobile":"PC",eventAction:"Library login modal Signup",eventCategory:"Menu",nonInteraction:!0})}))},e.submitLogin=function(){var a=$("#"+e.params.usernameInput_id),o=$("#"+e.params.passwordInput_id),n=a.val(),r=o.val(),i=$("#login_checkbox").is(":checked")?1:0,t=$('input[name="redirect"]').val(),l=$('input[name="token"]').val(),s=$('input[name="from"]').val(),g=!!e.recaptchaEnable&&grecaptcha.getResponse(page_params.recaptchas.loginRecaptcha),c=$("."+e.params.login_submit).data("ga-entry");if(e.resetErrorMessages(),""==n)return $("#error_username").show(),a.addClass("login_error"),e.resize_login_modal(),!1;if(""==r)return $("#error_password").show(),e.resize_login_modal(),o.addClass("login_error"),!1;if(!e.recaptchaEnable||""!==g){var m="redirect="+t+"&token="+l+"&remember_me="+i+"&from="+s+"&username="+n+"&password="+r;g&&(m=m+"&g-recaptcha-response="+g);var _=new XMLHttpRequest;return _.open("POST","/authenticate/authenticate",!0),_.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),_.onreadystatechange=function(){if(4===_.readyState)if(_.status>=200&&_.status<400){var a=JSON.parse(_.responseText);"library"==c&&ga("send","event",{eventLabel:"mobile"==page_params.global.platform?"mobile":"PC",eventAction:"Library Login success",eventCategory:"Menu",nonInteraction:!0}),e.callbackSuccess(a)}else location.reload},_.send(m),!1}e.resize_login_modal(),alert("Captcha missing")},e.callbackSuccess=function(a){a.redirect?document.location.assign(a.redirect):a.recaptcha&&0==e.recaptchaEnable?document.location.reload():(e.recaptchaEnable&&grecaptcha.reset(page_params.recaptchas.loginRecaptcha),a.messageLink?$(".invalid_error_msg").addClass("big_error").html(a.message+'</br><a href="'+a.redirectUrl+'">'+a.messageLink+"</a>"):$(".invalid_error_msg").text(a.message),$(".invalid_error_msg").show(),e.resize_login_modal())},e.resize_login_modal=function(){var a=$("#"+e.params.login_modal);a&&a.length&&a.colorbox.resize()},e.resetErrorMessages=function(){$("#error_username").hide(),$("#error_password").hide(),$(".invalid_error_msg").hide(),$('input[name="username"]').removeClass("login_error"),$('input[name="password"]').removeClass("login_error")},e.openOauthDialog=function(e){var a=(screen.width-540)/2,o=(screen.height-465)/4,n=window.open(e,"_blank","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=540, height=465, top="+o+", left="+a),r=setInterval((function(){try{null==n&&(window.clearInterval(r),location.reload())}catch(e){errorHandler(e)}}),500)},e.isRecaptchaEnable=function(){var a=$("#loginRecaptcha .g-recaptcha-response").val();return null!=a&&"undefined"!=a&&(e.trigger_login_form(),!0)}};try{var login_form=new LoginForm;login_form.init(page_params.loginForm)}catch(e){jsErrorsReporter&&jsErrorsReporter.sendReport({data_sent:page_params.loginForm,error:e.toString(),file_name:"login_form-1.0.0",function_name:"init"}),console.log("error in login_form")}var Login_Modal=function Login_Modal(){"use strict";var e=this;e.defaultSettings={selectors:{open_login_modal:"js_trigger_login",wrapper_open_login_modal:"js_wrap_trigger_login",login_action_message:"js_login_message",login_submit:"js-loginSubmitModal",loginform:"js_loginform"}},e.init=function(a){e.params=$.extend(!0,e.defaultSettings,a),e.login_modal=$("#"+e.params.selectors.wrapper_id),e.initColorbox(),e.addListeners()},e.addListeners=function(){$("."+e.params.selectors.open_login_modal).on("click",e.trigger_login_modal),$("."+e.params.selectors.wrapper_open_login_modal).on("click","."+e.params.selectors.open_login_modal,(function(a){e.trigger_login_modal(a),e.openColorbox()}))},e.trigger_login_modal=function(a){if(e.params.deactiveLoginModal)return!1;var o=$(this).data("login-action-message"),n=$(this).data("ga-entry");o=o||e.params.default_login_action_message,e.login_modal&&e.login_modal.length&&(e.login_modal.find("."+e.params.selectors.login_action_message).text(o),e.login_modal.find("."+e.params.selectors.login_submit).attr("data-ga-label",$(this).data("ga-label")),e.login_modal.find("."+e.params.selectors.login_submit).attr("data-ga-entry",n),"mobile"!=page_params.global.platform&&a.preventDefault())},e.initColorbox=function(){"mobile"!=page_params.global.platform&&$("#"+e.params.selectors.wrapper_id).length&&(e.colorbox_instance=$("."+e.params.selectors.open_login_modal).not("."+e.params.selectors.wrapper_open_login_modal+" ."+e.params.selectors.open_login_modal).colorbox({inline:!0,href:e.login_modal,fixed:!0,width:"610px",close:'<span class="rt_icon rt_circle_close close_icon"></span>'}))},e.openColorbox=function(){"mobile"!=page_params.global.platform&&(e.login_modal=$("#"+e.params.selectors.wrapper_id),$("#"+e.params.selectors.wrapper_id).length&&$.colorbox({inline:!0,href:e.login_modal,fixed:!0,width:"610px",close:'<span class="rt_icon rt_circle_close close_icon"></span>'}))}};try{var login_modal=new Login_Modal;login_modal.init(page_params.login_modal)}catch(e){jsErrorsReporter&&jsErrorsReporter.sendReport({data_sent:page_params.login_modal,error:e.toString(),file_name:"login_modal-1.0.0",function_name:"init"})}