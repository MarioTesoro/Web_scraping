function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _extends(){return(_extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r,a=arguments[e];for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t}).apply(this,arguments)}var defer=function(){var a=!1,n=[];return{resolved:function(){return a},resolve:function(t){if(!a){a=!0;for(var e=0,r=n.length;e<r;e++)n[e](t)}},promise:{then:function(t){a?t():n.push(t)}}}},ownProp=Object.prototype.hasOwnProperty;function createRecaptcha(){var t=defer();return{notify:function(){t.resolve()},wait:function(){return t.promise},render:function(t,e,r){this.wait().then(function(){r(window.grecaptcha.render(t,e))})},reset:function(t){void 0!==t&&(this.assertLoaded(),this.wait().then(function(){return window.grecaptcha.reset(t)}))},execute:function(t){void 0!==t&&(this.assertLoaded(),this.wait().then(function(){return window.grecaptcha.execute(t)}))},checkRecaptchaLoad:function(){ownProp.call(window,"grecaptcha")&&ownProp.call(window.grecaptcha,"render")&&this.notify()},assertLoaded:function(){if(!t.resolved())throw new Error("ReCAPTCHA has not been loaded")}}}var recaptcha=createRecaptcha(),CaptachaComponents=function(){"use strict";var r={},a=null,n=null;function t(t){n("verified",t)}function e(){n("expired")}function c(){n("error")}function i(){try{grecaptcha.render(a,_extends(_extends({},r),{},{callback:t,"expired-callback":e,"error-callback":c}))}catch(t){}}return{registerVueComponent:function(){Vue.customElement("v-recaptcha",{props:{sitekey:{type:String,required:!0},theme:{type:String,default:"dark"},badge:{type:String},type:{type:String,default:"v2"},size:{type:String},tabindex:{type:String},loadRecaptchaScript:{type:Boolean,default:!1},recaptchaScriptId:{type:String,default:"__RECAPTCHA_SCRIPT"},recaptchaHost:{type:String,default:"www.google.com"},language:{type:String,default:""}},beforeMount:function(){var t;document.getElementById(this.recaptchaScriptId)||"undefined"!=typeof grecaptcha||((t=document.createElement("script")).id=this.recaptchaScriptId,t.src="https://"+this.recaptchaHost+"/recaptcha/api.js?onload=vueRecaptchaApiLoaded&render=explicit&hl="+this.language,t.async=!0,t.defer=!0,document.head.appendChild(t))},mounted:function(){var e=this;recaptcha.checkRecaptchaLoad();var t=_extends(_extends({},this.$props),{},{callback:this.emitVerify,"expired-callback":this.emitExpired,"error-callback":this.emitError}),r=this.$slots.default?this.$el.children[0]:this.$el;recaptcha.render(r,t,function(t){e.$widgetId=t,e.$emit("render",t)})},methods:{reset:function(){recaptcha.reset(this.$widgetId)},execute:function(){recaptcha.execute(this.$widgetId)},emitVerify:function(t){this.$emit("verify",t)},emitExpired:function(){this.$emit("expired")},emitError:function(){this.$emit("error")}},render:function(t){return t("div",{},this.$slots.default)}})},registerComponent:function(t,e){t&&"function"==typeof e&&(n=e,r={sitekey:(a=t).getAttribute("data-sitekey"),theme:t.getAttribute("data-theme")?t.getAttribute("data-theme"):"dark",type:t.getAttribute("data-type")?t.getAttribute("data-type"):"v2",recaptchaScriptId:t.getAttribute("data-scriptId")?t.getAttribute("data-scriptId"):"__RECAPTCHA_SCRIPT",recaptchaHost:t.getAttribute("data-recaptchaHost")?t.getAttribute("data-recaptchaHost"):"www.google.com",language:t.getAttribute("data-language")?t.getAttribute("data-language"):""}),"object"===("undefined"==typeof grecaptcha?"undefined":_typeof(grecaptcha))?i():document.getElementById(r.recaptchaScriptId)||"undefined"!=typeof grecaptcha||((t=document.createElement("script")).id=r.recaptchaScriptId,t.src="https://"+r.recaptchaHost+"/recaptcha/api.js?onload=recaptchaApiLoaded&render=explicit&hl="+r.language,t.async=!0,t.defer=!0,document.head.appendChild(t))},renderCaptcha:i,getCaptchaResponse:function(){return grecaptcha.getResponse()},resetCaptcha:function(){"undefined"!=typeof grecaptcha&&grecaptcha.reset()}}}();"undefined"!=typeof window&&(window.vueRecaptchaApiLoaded=recaptcha.notify,window.recaptchaApiLoaded=CaptachaComponents.renderCaptcha);
function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var PurchaseFlow_Utils=function(){"use strict";var l=this;l.trackingCreditCardParams={},l.getCurrentOpenedModal=function(e,t){if(t=void 0!==t&&t,e.querySelector(".active_modal")){var o=e.querySelector(".active_modal").getAttribute("data-modal");return t?e.querySelector("."+o):o}return""},l.openSelectedModal=function(e,t){t.querySelector(".active_modal")&&MG_Utils.removeClass(t.querySelector(".active_modal"),"active_modal"),MG_Utils.addClass(t.querySelector(e),"active_modal"),t.setAttribute("data-activeModal",e.substring(1))},l.addModalCloseListeners=function(t,o,a,r){r=void 0!==r?r:function(){};function i(e){MG_Utils.hasClass(t,"leave_confirmation")?(e="leave_confirmation_modal"==l.getCurrentOpenedModal(t)&&"close_button"===e,"leave_confirmation_modal"!=l.getCurrentOpenedModal(t)?(t.querySelector(".leave_confirmation_modal .leave_confirmation_buttons").setAttribute("data-previousModal",l.getCurrentOpenedModal(t)),l.openSelectedModal(".leave_confirmation_modal",t)):e&&(e=t.querySelector(".leave_confirmation_modal .leave_confirmation_buttons").getAttribute("data-previousModal"),l.openSelectedModal("."+e,t))):(a.closeModal(r),MG_Utils.hasClass(t,"reload_on_close")?o.dismissUrl?window.location.href=o.dismissUrl:window.location.reload(!0):MG_Utils.hasClass(t,"redirect_on_close")&&o.redirectWithoutParamsUrl&&(window.location.href=o.redirectWithoutParamsUrl))}MG_Utils.addEventHandler(document.querySelector("#modalWrapMTubes"),"click",function(e){"modalWrapMTubes"===(e.target&&e.target.id||e.srcElement&&e.srcElement.id)&&(getSelection().toString()||MG_Utils.hasClass(t,"cannot_close")||i("outer_close"))}),[].forEach.call(t.querySelectorAll(".js_close_modal"),function(e){MG_Utils.addEventHandler(e,"click",function(){i("close_button")})})},l.addLeaveModalListeners=function(t,o,a,r){r=void 0!==r?r:function(){},MG_Utils.addEventHandler(t.querySelector(".js_cancel_leave_modal"),"click",function(e){e=e.target.parentElement.getAttribute("data-previousModal");l.openSelectedModal("."+e,t)}),MG_Utils.addEventHandler(t.querySelector(".js_confirm_leave_modal"),"click",function(e){a.closeModal(r),"undefined"!=typeof recaptchaComplete&&(recaptchaComplete=!1),PurchaseFlow_LoginSignup.requireCaptcha=!1,"pfCreditCardModal"==e.target.parentElement.getAttribute("data-previousModal")&&l.trackCreditCardModal(PF_CREDITCARDMODAL_TRACKING.trackingStatus.ccFormClose),MG_Utils.hasClass(t,"reload_on_close")&&(o.dismissUrl?window.location.href=o.dismissUrl:"?customvideo=1"===window.location.search?window.location.href=window.location.origin+window.location.pathname:window.location.reload(!0))})},l.ageModal_triggerPurchaseFlow=function(){"undefined"!=typeof fanclubPurchaseFlowParams&&fanclubPurchaseFlowParams.triggerPurchaseFlow&&fanclubPurchaseFlowParams.modelId&&fanclubPurchaseFlow.triggerPurchaseModal(fanclubPurchaseFlowParams.modelId),"undefined"!=typeof customVideoPurchaseFlowParams&&customVideoPurchaseFlowParams.triggerCustomVideo&&customVideoPurchaseFlowParams.modelId&&customVideoPurchaseFlow.triggerPurchaseFlow(customVideoPurchaseFlowParams.modelId,!0),"undefined"!=typeof Tipping_PurchaseFlow_Params&&Tipping_PurchaseFlow_Params.isModelPage&&("#tip"===window.location.hash||0<window.location.search.indexOf("sendTip=1"))&&Tipping_PurchaseFlow_Params.modelUsername&&tippingPurchaseFlow.triggerPurchaseFlow(Tipping_PurchaseFlow_Params.modelUsername)},l.noAgeModal=function(e){var t=document.getElementById("js-ageDisclaimerModal")&&!getCookieAdvanced("accessAgeDisclaimerPH"),o=e.vkOauth_ageModal,e=e.utah_ageModal&&!getCookieAdvanced("accessPH");return!t&&!o&&!e},l.openSuccessModal=function(e,t,o,a){a=void 0!==a&&a,o.openModal();var r,i=document.querySelector(e),e=i.querySelector(".fanclubUpsell");l.openSelectedModal(".pf_success_modal",i),MG_Utils.addClass(i,"redirect_on_close"),l.addModalCloseListeners(i,t,o),a&&"function"==typeof a&&a(i),e&&(r=i.querySelector(".js_fanclubUpsell"),e=document.querySelectorAll(".modalMTubes .fcUpsellVideoList"),MG_Utils.addClass(i,"withUpsell"),0<e.length&&MG_Scroll.init({selector:e,width:"auto",height:"auto",color:"#555",railColor:"#2e2e2e",railOpacity:"1",opacity:"1",wrapperClass:"scrollContentWrapper",horizontal:!0}),r&&r.addEventListener("click",function(e){o.closeModal(),r.getAttribute("data-trackingLocationTab")&&(fanclubPurchaseFlow.params.trackingLocationTab=r.getAttribute("data-trackingLocationTab")),fanclubPurchaseFlow.triggerPurchaseModal(r.getAttribute("data-model_id")),"undefined"!=typeof history&&history.pushState&&void 0!==t.redirectWithoutParamsUrl&&history.pushState({},null,t.redirectWithoutParamsUrl)}))},l.addChangeCCListeners=function(e,o,a,r){a=void 0!==a&&a,r=void 0!==r&&r,e.addEventListener("click",function(e){var t;MG_Utils.hasClass(e.target,"jsChangeCC")&&(t=a&&r?r.getAjaxData():{},e.target.hasAttribute("data-model_id")&&(t.modelId=e.target.getAttribute("data-model_id")),t.newCC=!0,MG_Utils.ajaxCall({type:"POST",data:t,url:o,success:function(e){"PASS"==e.success&&(window.location.href=e.redirectUrl)}}))})},l.toggleLoading=function(e,t,o){e=e.querySelector(".purchase_loading_img").cloneNode(!0);t&&e&&("show"==o?(t.setAttribute("data-originalText",t.innerText),t.innerHTML="",t.appendChild(e)):(t.removeChild(t.querySelector(".purchase_loading_img")),t.innerText=t.getAttribute("data-originalText")))},l.addFailureModalTryAgainListener=function(o,a,r,i,n){i=!(void 0===i||!i)&&i,MG_Utils.addEventHandler(a,"click",function(e){purchaseFlow_Utils.toggleLoading(o,a,"show");var t={tryAgain:!0};i&&(t=MG_Utils.extendSimple(t,i)),MG_Utils.ajaxCall({type:"POST",data:t,url:r,success:function(e){"PASS"!=e.success&&e.error?purchaseFlow_Utils.toggleLoading(o,a,"hide"):"function"==typeof n?n(e.redirectUrl,e.pornhubUUID):window.location.href=e.redirectUrl}})})},l.showCreditCardModal=function(e){return!MG_Utils.hasClass(document.documentElement,"ie")&&void 0!==e.needCC&&e.needCC},l.setupCreditCardModal=function(e,t,o,a){o=!(void 0===o||!o)&&o;var r,i=!(!(a=!(void 0===a||!a)&&a)||void 0===a.al)&&a.al,n=e.querySelector(".ccPurchaseInfo");l.trackingCreditCardParams={productID:n.getAttribute("data-trackingProductID"),modelId:n.getAttribute("data-trackingModelID"),amount:n.getAttribute("data-trackingAmount"),isDiscounted:l.trackingCreditCardParams.isDiscounted||n.getAttribute("data-trackingIsDiscounted"),transactionId:null,premiumUserInfo:null,itemId:n.getAttribute("data-trackingItemId")},o&&(r=-1!==o.indexOf("$")?"":"$",n=e.querySelector(".totalPrice .priceRight"),e.querySelector(".ccPurchasePrice").innerText=r+o,l.trackingCreditCardParams.amount=o,n&&!n.innerText&&(o=(r+o).replace(/ \/ \w+/g,""),creditCardV2.setPriceValues("set",e,o))),l.openSelectedModal(".pfCreditCardModal",e),MG_Utils.addClass(e,"leave_confirmation"),MG_Utils.addClass(e,"cannot_close"),CREDIT_CARD_MODAL.getProbillerApiUrl=t,a&&(CREDIT_CARD_MODAL.getProbillerApiAjaxData=a),CREDIT_CARD_MODAL.modelId=l.trackingCreditCardParams.modelId,i&&(CREDIT_CARD_MODAL.premiumUserInfo=i,l.trackingCreditCardParams.premiumUserInfo=i),l.trackCreditCardModal(PF_CREDITCARDMODAL_TRACKING.trackingStatus.ccFormOpen),creditCardModule.init(e,CREDIT_CARD_FORM.version)},l.trackCreditCardModal=function(e){MG_Utils.ajaxCall({type:"POST",url:PF_CREDITCARDMODAL_TRACKING.trackingUrl,data:{modelId:l.trackingCreditCardParams.modelId,amount:l.trackingCreditCardParams.amount,productID:l.trackingCreditCardParams.productID,site:"ph",isDiscounted:l.trackingCreditCardParams.isDiscounted,modelState:e,transactionId:l.trackingCreditCardParams.transactionId,al:l.trackingCreditCardParams.premiumUserInfo,itemId:l.trackingCreditCardParams.itemId}})},l.setupCouponCode=function(e,t){couponCodeModule.init(e,t)}};try{var purchaseFlow_Utils=new PurchaseFlow_Utils}catch(e){console.log("ERROR === Purchase Flow Utils ==="),console.log(e)}var couponCodeModule=function(){var r={};function a(e){e=void 0!==e&&e,MG_Utils.addClass(r.inputCoupon,"error"),e?r.couponError.innerText=e:0==r.inputCoupon.value.length&&(r.couponError.innerText=pfCouponCode_Params.noCouponError)}function i(e){"disable"==e?(MG_Utils.addClass(r.submitBtn,"disabled"),r.submitBtn.setAttribute("disabled",!0)):(MG_Utils.removeClass(r.submitBtn,"disabled"),r.submitBtn.removeAttribute("disabled"))}function n(e,t,o,a){a=void 0!==_typeof(a)?a:0,r.purchaseFlow.params.couponCode=e,PF_CREDITCARDMODAL_TRACKING.isDiscounted=e?1:0,!pfCouponCode_Params.liu&&purchaseFlow_LoginSignup&&(purchaseFlow_LoginSignup.params.couponCode=e),"v2"==CREDIT_CARD_FORM.version&&(null==e?creditCardV2.setPriceValues("reset",o):creditCardV2.setPriceValues("set",o,t,a))}return{init:function(o,e){var t=purchaseFlow_Utils.getCurrentOpenedModal(o,!0);if(!document.querySelector(".addCouponContainer"))return!1;n(null,(r={purchaseFlow:e,addCouponContainer:t.querySelector(".addCouponContainer"),showCouponFieldBtn:t.querySelector(".js-showCouponField"),couponFieldSection:t.querySelector(".inputCoupon"),successfulCouponSection:t.querySelector(".successfulCoupon"),inputCoupon:t.querySelector(".js-couponCodeInput"),submitBtn:t.querySelector(".js-submitCouponCode"),couponError:t.querySelector(".couponError"),removeCoupon:t.querySelector(".js-removeCoupon"),priceElm:t.querySelector(".js-pfPurchasePrice"),originalPriceElm:t.querySelector(".js-pfPurchasePrice").cloneNode(!0)}).addCouponContainer.getAttribute("data-originalPrice"),o),i("disable"),r.showCouponFieldBtn&&r.showCouponFieldBtn.addEventListener("click",function(){MG_Utils.addClass(r.showCouponFieldBtn,"displayNone"),r.couponFieldSection&&MG_Utils.removeClass(r.couponFieldSection,"displayNone")}),r.inputCoupon&&r.inputCoupon.addEventListener("keyup",function(e){0<e.target.value.length?(i("enable"),"13"==e.keyCode&&r.submitBtn&&r.submitBtn.click()):i("disable")}),r.submitBtn&&r.submitBtn.addEventListener("click",function(){var t;MG_Utils.removeClass(r.inputCoupon,"error"),r.couponError.innerText="",r.inputCoupon,0<r.inputCoupon.value.length&&!MG_Utils.hasClass(r.submitBtn,"disabled")?(i("disable"),t=r.inputCoupon.value,MG_Utils.ajaxCall({type:"POST",data:{modelId:r.addCouponContainer.getAttribute("data-modelId"),itemId:r.addCouponContainer.getAttribute("data-itemId"),couponCode:t,itemType:r.addCouponContainer.getAttribute("data-itemType")},url:pfCouponCode_Params.applyCouponUrl,success:function(e){"FAIL"==e.success||e.error?(a(e.message),i("enable")):(n(t,e.finalAmount,o,e.finalDiscountPercent),r.successfulCouponSection&&(MG_Utils.removeClass(r.successfulCouponSection,"displayNone"),r.successfulCouponSection.querySelector(".greenText").innerText="'"+t+"'",r.successfulCouponSection.querySelector(".js-amountOff").innerText=e.finalDiscountPercent),r.priceElm&&(r.priceElm.setAttribute("data-originalPercent",r.priceElm.getAttribute("data-percent")),r.priceElm.setAttribute("data-percent",e.finalDiscountPercent),r.priceElm.innerHTML='<div class="strikethrough">'+r.addCouponContainer.getAttribute("data-originalPrice")+"</div>"+e.finalAmount),r.couponFieldSection&&MG_Utils.addClass(r.couponFieldSection,"displayNone"),r.inputCoupon&&(r.inputCoupon.value=""),e.isGift&&MG_Utils.addClassMultiple(o.querySelectorAll(".changeCardContainer"),"display-none"))}})):a()}),r.removeCoupon.addEventListener("click",function(){n(null,r.addCouponContainer.getAttribute("data-originalPrice"),o),i("enable"),r.successfulCouponSection&&(MG_Utils.addClass(r.successfulCouponSection,"displayNone"),r.successfulCouponSection.querySelector(".greenText").innerText="",r.successfulCouponSection.querySelector(".js-amountOff").innerText=""),r.priceElm&&(r.priceElm.innerHTML=r.originalPriceElm.innerHTML,r.priceElm.setAttribute("data-percent",r.priceElm.getAttribute("data-originalPercent"))),r.couponFieldSection&&MG_Utils.removeClass(r.couponFieldSection,"displayNone"),MG_Utils.removeClassMultiple(o.querySelectorAll(".changeCardContainer"),"display-none")}),(t=function(e){var t=window.location.search,e=t.indexOf(e);return-1<e?(searchLocationNew=t.substring(e),-1<searchLocationNew.indexOf("&")?searchLocationNew.substring(0,searchLocationNew.indexOf("&")):searchLocationNew.substring(0)):""}("coupon="))&&r.showCouponFieldBtn&&r.inputCoupon&&r.submitBtn&&(r.showCouponFieldBtn.click(),r.inputCoupon.value=t.replace("coupon=",""),i("enable"),r.submitBtn.click())},applyCoupon:function(e){e&&r.showCouponFieldBtn&&r.inputCoupon&&r.submitBtn&&(r.showCouponFieldBtn.click(),r.inputCoupon.value=e,i("enable"),r.submitBtn.click())}}}(),pfLast4=function(){var i={};function n(e){var e=(e=void 0!==e?e:i.currentModal).querySelectorAll(".lastFour"),t="";return[].forEach.call(e,function(e){t+=e.value}),t}function l(e){e=e.target;e&&MG_Utils.hasClass(e,"lastFour")&&e.select()}return{init:function(e,t,o){o=void 0!==o&&o;var a,r=purchaseFlow_Utils.getCurrentOpenedModal(e,!0);i={purchaseFlow:t,parentModal:e,currentModal:r,last4Container:r.querySelector(".pfLastDigits"),first6:r.querySelector(".first6"),userAvatar:r.querySelector(".digitsUserAvatar"),userName:r.querySelector(".digitsUserName"),submitButton:r.querySelector(".jsLastDigitsSubmit")},(r=closestElement(r,".purchaseFlowModal"))&&MG_Utils.addClass(r,"withLast4"),o&&o.first6&&function(e){{var t;i.first6&&(t=e.substring(0,4),e=e.substring(4,6),i.first6.innerHTML=t+"<span>"+e+"**</span>****",MG_Utils.addClass(i.first6,"active"))}}(o.first6),o&&o.avatar&&o.username&&i.userAvatar&&i.userName&&(i.userAvatar.setAttribute("src",o.avatar),i.userName.innerText=o.username),a=!(!i.submitButton||"1"!=i.submitButton.getAttribute("data-autoSubmit")),i.last4Container&&(i.last4Container.addEventListener("focus",l,!0),MG_Utils.browser.isAppleMobileDevice&&i.last4Container.addEventListener("click",l,!0),i.last4Container.addEventListener("input",function(e){e=e.target;MG_Utils.hasClass(e,"lastFour")&&1<=e.value.length&&(e.value=e.value.slice(0,1),MG_Utils.hasClass(e,"lastFourEnd")||e.nextElementSibling.focus(),4==n().length&&(i.submitButton&&MG_Utils.removeClass(i.submitButton,"disabled"),a&&i.purchaseFlow.handleLastDigitsAjax(i.parentModal,i.currentModal,n(),i.submitButton)))},!0),i.last4Container.addEventListener("keydown",function(e){var t,o;MG_Utils.hasClass(e.target,"lastFour")&&(o=(t=e.keyCode||e.which)<96||105<t,-1==[9,8,46,13,16,229].indexOf(t)&&(t<48||57<t)&&o&&e.preventDefault(),a||"13"!=e.keyCode||!i.submitButton||MG_Utils.hasClass(i.submitButton,"disabled")||(MG_Utils.addClass(i.submitButton,"disabled"),i.purchaseFlow.handleLastDigitsAjax(i.parentModal,i.currentModal,n(),i.submitButton)))},!0))},getLast4:n}}();
var FanclubPurchaseFlow=function(){"use strict";var o=this,l=[];o.defaultSettings={showSuccessModal:!1,showFailureModal:!1,dynamicallyTargetButton:!0,dismissUrl:"",fanClubPrice:"",modelId:"",trackingDataHash:null,trackingSourcePage:"",trackingLocationTab:""},o.pornhubUUID=null,o.init=function(a){o.params=MG_Utils.extendSimple(o.defaultSettings,a),o.initModals(),o.add_listeners()},o.initModals=function(){o.purchaseFlowModal=new MG_Modal({closeButton:!1,closeDocument:!1,content:document.querySelector(".fanclub_purchase_flow_modals_container"),className:"fanclubPurchaseFlowModal purchaseFlowModal",lazyload:!0})},o.add_listeners=function(){var a,e;o.params.dynamicallyTargetButton?MG_Utils.addEventHandler(document,"click",function(a){var e,t;a.target&&(t=(e=a.target.parentNode)?e.parentNode:null,MG_Utils.hasClass(a.target,"js_becomeFan")?o.buttonTriggerModal(a.target):e&&MG_Utils.hasClass(e,"js_becomeFan")?o.buttonTriggerModal(e):t&&MG_Utils.hasClass(t,"js_becomeFan")&&o.buttonTriggerModal(t))}):(e=document.querySelectorAll(".js_becomeFan"),[].forEach.call(e,function(e){MG_Utils.addEventHandler(e,"click",function(a){o.buttonTriggerModal(e)})})),o.params.triggerPurchaseFlow&&o.params.isModelPage&&o.params.modelId&&(o.params.redirectToMH&&o.params.modelhubUrl?window.location.href=o.params.PHredirectToMHUrl+"?url="+o.params.modelhubUrl+"/fanclub":purchaseFlow_Utils.noAgeModal(o.params)&&o.triggerPurchaseModal(o.params.modelId)),o.params.showSuccessModal&&purchaseFlow_Utils.openSuccessModal(".contentMTubes .fanclub_purchase_flow_modals",o.params,o.purchaseFlowModal),o.params.showFailureModal&&(o.purchaseFlowModal.openModal(),a=document.querySelector(".contentMTubes .fanclub_purchase_flow_modals"),purchaseFlow_Utils.openSelectedModal(".pf_failure_modal",a),MG_Utils.addClass(a,"redirect_on_close"),purchaseFlow_Utils.addModalCloseListeners(a,o.params,o.purchaseFlowModal),e=purchaseFlow_Utils.getCurrentOpenedModal(a,!0).querySelector(".js_retryPurchase"),purchaseFlow_Utils.addFailureModalTryAgainListener(a,e,o.params.changeCCAjax,o.getAjaxData(),o.trackLegacyProbiller))},o.buttonTriggerModal=function(a){o.params.redirectToMH&&a.getAttribute("data-mh_url")?window.location.href=o.params.PHredirectToMHUrl+"?url="+a.getAttribute("data-mh_url")+"?becomeafan=1":(a.getAttribute("data-trackingLocationTab")&&(o.params.trackingLocationTab=a.getAttribute("data-trackingLocationTab")),o.triggerPurchaseModal(a.getAttribute("data-model_id")))},o.addNewEventHandlers=function(e,a){MG_Utils.addEventHandler(e.querySelector(".js_purchase_modal_submit"),"click",function(a){MG_Utils.addClass(a.target,"disabled"),"true"==a.target.getAttribute("data-loginSignup")?(purchaseFlow_Utils.openSelectedModal(".login_signup_modal",e),purchaseFlow_LoginSignup&&(purchaseFlow_LoginSignup.params.customExtraData=o.getExtraLoginSignupData(),purchaseFlow_LoginSignup.addListeners(e,fanclubPurchaseFlow)),o.removeInlineOnclick(["js_purchase_flow_login","js_purchase_flow_signup"])):a.target.hasAttribute("data-needCC")?purchaseFlow_Utils.setupCreditCardModal(e,o.params.initiatePurchaseFlowAjax,o.params.fanClubPrice,o.getAjaxData()):o.trackLegacyProbiller(a.target.getAttribute("data-redirectUrl"))}),MG_Utils.addEventHandler(e.querySelector(".js_report_other_perks"),"click",function(a){MG_Utils.hasClass(a.target,"disabled")||o.reportOtherPerks(a.target)}),MG_Utils.addEventHandler(e.querySelector(".js_alreadyFanTip"),"click",function(a){o.purchaseFlowModal.closeModal(function(){window.location=a.target.getAttribute("data-url"),o.params.isModelPage&&!o.params.dismissUrl&&window.location.reload(!0)})}),purchaseFlow_Utils.addModalCloseListeners(e,o.params,o.purchaseFlowModal),purchaseFlow_Utils.addLeaveModalListeners(e,o.params,o.purchaseFlowModal),purchaseFlow_Utils.addChangeCCListeners(e,o.params.changeCCAjax)},o.addLastDigitEventListeners=function(a,e){var t=purchaseFlow_Utils.getCurrentOpenedModal(a,!0),r=t.querySelector(".jsLastDigitsSubmit");pfLast4.init(a,fanclubPurchaseFlow,e),r&&r.addEventListener("click",function(){MG_Utils.hasClass(r,"disabled")||(MG_Utils.addClass(r,"disabled"),o.callGoogleAnalytics(r),o.handleLastDigitsAjax(a,t,pfLast4.getLast4(t),r))})},o.triggerPurchaseModal=function(t){o.purchaseFlowModal.openModal(function(){MG_Utils.addClass(document.querySelector(".modalMTubes.fanclubPurchaseFlowModal"),"loadingModal");var a={modelId:t};o.params.trackingSourcePage&&(a.source_page=o.params.trackingSourcePage),o.params.trackingLocationTab&&(a.location_tab=o.params.trackingLocationTab),o.params.trackingDataHash&&(a.trackingDataHash=o.params.trackingDataHash),MG_Utils.ajaxCall({type:"POST",data:a,url:o.params.initiatePurchaseFlowAjax,success:function(e){MG_Utils.removeClass(document.querySelector(".modalMTubes.fanclubPurchaseFlowModal"),"loadingModal");var a=document.querySelector(".contentMTubes .fanclub_purchase_flow_modals");void 0!==e.pbMonitoring.uuid&&(o.pornhubUUID=e.pbMonitoring.uuid),"PASS"==e.success?(purchaseFlow_Utils.openSelectedModal(".fanclub_purchase_modal",a),o.replaceModelInfo(e,a,t),o.addNewEventHandlers(a,e),o.populatePurchaseModal(e,a),document.querySelector('div[data-ga="purchase_logged_in"]')&&o.removeInlineOnclick(["jsLastDigitsSubmit"]),350<a.querySelector(".fanclub_purchase_top_content").clientHeight&&o.initScroll(a.querySelectorAll(".fanclub_purchase_top_content"),"100%","350px")):e&&void 0!==e.fanclubInactive&&e.fanclubInactive&&(a=document.querySelector(".contentMTubes .fanclub_purchase_flow_modals"),MG_Utils.addClass(a.querySelector(".inactive_fanclub_modal"),"active_modal"),[].forEach.call(a.querySelectorAll(".modelName"),function(a){a.innerText=e.modelInfo.modelName}),purchaseFlow_Utils.addModalCloseListeners(a,o.params,o.purchaseFlowModal))}})})},o.trackLegacyProbiller=function(e,a){void 0!==a&&""!==a&&(o.pornhubUUID=a);a={pornhubUUID:o.pornhubUUID};o.params.trackingSourcePage&&(a.trackingSourcePage=o.params.trackingSourcePage),o.params.trackingLocationTab&&(a.trackingLocationTab=o.params.trackingLocationTab),MG_Utils.ajaxCall({type:"POST",requestType:"text/json; charset=UTF-8",data:a,url:o.params.probillerMonitoringFanclubLegacy,success:function(a){void 0!==e&&""!==e&&(window.location.href=e)},error:function(){void 0!==e&&""!==e&&(window.location.href=e)}})},o.populatePurchaseModal=function(a,t){a.perks&&a.perks.forEach(function(a){var e=t.querySelector(".perks_template .perk_container").cloneNode(!0);e.querySelector(".perk_content").innerText=a,t.querySelector(".fanclub_purchase_perks_list").appendChild(e)}),a.otherPerks&&(a.otherPerks.forEach(function(a){var e=t.querySelector(".perks_template .perk_container").cloneNode(!0);e.querySelector(".perk_content").innerText=a,t.querySelector(".fanclub_purchase_other_perks_list").appendChild(e)}),MG_Utils.addClass(t.querySelector(".fanclub_purchase_other_perks"),"active"),MG_Utils.addClass(t.querySelector(".fanclub_purchase_top_content"),"two_perks_list")),a.showLast4?(MG_Utils.addClass(t.querySelector(".fanclub_purchase_bottom"),"purchase_modal_2"),o.addLastDigitEventListeners(t,a)):MG_Utils.addClass(t.querySelector(".fanclub_purchase_bottom"),"purchase_modal_1"),a.loginSignup&&t.querySelector(".js_purchase_modal_submit").setAttribute("data-loginSignup",!0),void 0!==a.redirectUrl&&t.querySelector(".js_purchase_modal_submit").setAttribute("data-redirectUrl",a.redirectUrl),purchaseFlow_Utils.showCreditCardModal(a)&&t.querySelector(".js_purchase_modal_submit").setAttribute("data-needCC",a.needCC),void 0!==a.paidVideoOptOutMessage&&a.paidVideoOptOutMessage&&(t.querySelector(".fanclub_purchase_optout").innerHTML=a.paidVideoOptOutMessage)},o.replaceModelInfo=function(a,e,t){var r=a.modelInfo.modelName,l=a.modelInfo.priceFrequency;e.innerHTML=e.innerHTML.replace(/FANCLUB_PRICE/g,l),e.innerHTML=e.innerHTML.replace(/MODEL_ID/g,t),e.innerHTML=e.innerHTML.replace(/FANCLUB_ID/g,a.fanclubId),e.innerHTML=e.innerHTML.replace(/PRICE_DISCLAIMER/g,a.modelInfo.priceDisclaimer),o.params.modelId=t,[].forEach.call(e.querySelectorAll(".modelName"),function(a){a.innerText=r}),o.params.fanClubPrice=l},o.reportOtherPerks=function(e){MG_Utils.ajaxCall({type:"POST",data:{modelId:o.params.modelId},url:o.params.reportOtherPerksAjax,success:function(a){"PASS"==a.success?(e.innerHTML=o.params.reportOtherPerksThankYouTxt,MG_Utils.addClass(e,"notClickable"),MG_Utils.addClass(e,"disabled")):"FAIL"==a.success&&(e.innerHTML=a.message,MG_Utils.addClass(e,"notClickable"),MG_Utils.addClass(e,"disabled"),MG_Utils.addClass(e,"error"))}})},o.handleLastDigitsAjax=function(e,a,t,r){purchaseFlow_Utils.toggleLoading(e,r,"show");var l=a.querySelector(".pfLastDigitsError");l&&(MG_Utils.removeClass(l,"active"),l.innerHTML=""),MG_Utils.ajaxCall({type:"POST",data:o.getAjaxData(t),url:o.params.lastDigitsAjax,success:function(a){"FAIL"==a.success?(l&&(MG_Utils.addClass(l,"active"),l.innerHTML=a.message),purchaseFlow_Utils.toggleLoading(e,r,"hide"),r&&MG_Utils.removeClass(r,"disabled")):(a.MixpanelEvent&&"undefined"!=typeof mixpanel&&mixpanel.track(a.MixpanelEvent.eventName,a.MixpanelEvent.event),window.location.href=a.redirectUrl)}})},o.initScroll=function(a,e,t){MG_Scroll.init({selector:a,width:e,height:t,color:"#F39000",railColor:"#2e2e2e",railOpacity:"1",opacity:"1",wrapperClass:"scrollContentWrapper"})},o.handleAfterLoginSignup=function(a,e){var t;document.querySelector('div[data-ga="login"]')&&o.callGoogleAnalytics(document.querySelector('div[data-ga="login"]')),MG_Utils.removeClass(a,"leave_confirmation"),MG_Utils.addClass(a,"reload_on_close"),void 0!==e.responseData&&void 0!==e.responseData.redirect&&(o.params.dismissUrl=e.responseData.redirect),void 0!==e.responseData&&void 0!==e.responseData.autoLoginParameter&&(o.params.premiumUserInfo=e.responseData.autoLoginParameter),void 0!==e.last4Required&&e.last4Required?(t=a.querySelector(".fanclub_purchase_bottom"),purchaseFlow_Utils.openSelectedModal(".fanclub_purchase_modal",a),t&&(MG_Utils.removeClass(t,"purchase_modal_1"),MG_Utils.addClass(t,"purchase_modal_2")),document.querySelector('div[data-ga="purchase_after_login"]')&&o.removeInlineOnclick(["jsLastDigitsSubmit"]),o.addLastDigitEventListeners(a,e)):void 0!==e.isAlreadyFan&&e.isAlreadyFan?(purchaseFlow_Utils.openSelectedModal(".already_fan_modal",a),a.querySelector(".already_fan_send_tip").setAttribute("data-url",e.tipUrl)):purchaseFlow_Utils.showCreditCardModal(e)?purchaseFlow_Utils.setupCreditCardModal(a,o.params.initiatePurchaseFlowAjax,o.params.fanClubPrice,o.getAjaxData()):void 0!==e.redirectUrl&&(window.location.href=e.redirectUrl)},o.removeInlineOnclick=function(a){[].forEach.call(a,function(a){a=document.querySelectorAll(".modalMTubes ."+a);a&&[].forEach.call(a,function(a){o.buildOnclickEvent(a,a.getAttribute("data-ga")),a.onclick=null})})},o.buildOnclickEvent=function(a,e){if(l){for(var t=0;t<l.length;t++)if(l[t][e])return;var r={};r[e]=a.onclick,l.push(r)}},o.callGoogleAnalytics=function(e){l&&[].forEach.call(l,function(a){!e.hasAttribute("data-ga")||(a=a[e.getAttribute("data-ga")])&&a()})},o.getAjaxData=function(a){a=void 0!==a&&a;var e={modelId:o.params.modelId};return o.params.token&&(e.token=o.params.token),o.params.premiumUserInfo&&(e.al=o.params.premiumUserInfo),a&&(e.last4=a),o.params.trackingSourcePage&&(e.source_page=o.params.trackingSourcePage),o.params.trackingLocationTab&&(e.location_tab=o.params.trackingLocationTab),o.params.trackingDataHash&&(e.trackingDataHash=o.params.trackingDataHash),e},o.getExtraLoginSignupData=function(){var a={};return o.params.trackingDataHash&&(a.trackingDataHash=o.params.trackingDataHash),o.params.trackingSourcePage&&(a.source_page=o.params.trackingSourcePage),o.params.trackingLocationTab&&(a.location_tab=o.params.trackingLocationTab),a}};try{var fanclubPurchaseFlow=new FanclubPurchaseFlow;fanclubPurchaseFlow.init("undefined"!=typeof fanclubPurchaseFlowParams?fanclubPurchaseFlowParams:{})}catch(a){console.log("ERROR === Fanclub Purchase Flow ==="),console.log(a)}
function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var PurchaseFlow_LoginSignup=function o(){"use strict";var l=this;l.captchaResponse="",l.defaultSettings={timer:null,idleTime:500,signup_errors:{},couponCode:"",customExtraData:null},l.init=function(e){l.params=MG_Utils.extendSimple(l.defaultSettings,e)},l.addListeners=function(i,e,a){a=void 0!==a?a:{},l.params.purchaseFlow=void 0!==e?e:null,a.useDefaultFunctionality&&l.useDefaultFunctionality(i),MG_Utils.addClass(i,"leave_confirmation");var n=i.querySelectorAll(".login_signup_tabs_item");[].forEach.call(n,function(s){MG_Utils.addEventHandler(s,"click",function(e){l.captchaResponse="",o.requireCaptcha=!1;var a=i.getElementsByClassName("g-recaptcha");if(a)for(var r=0;r<a.length;r++)a[r].hasAttribute("id")&&-1<a[r].getAttribute("id").indexOf("cpt")&&("login_signup_modal_login"==s.getAttribute("data-tabid")?a[r].innerHTML="":l.vCaptchaInstance.reset());MG_Utils.removeClassMultiple(n,"active_tab"),MG_Utils.addClass(e.target,"active_tab");var t=i.querySelectorAll(".login_signup_content_wrap .login_signup_content"),e=i.querySelector("."+e.target.getAttribute("data-tabclass"));MG_Utils.removeClassMultiple(t,"active"),e&&MG_Utils.addClass(e,"active")})}),"signup"==a.defaultTab&&i.querySelectorAll(".login_signup_tabs_item")[1].click(),l.addLoginListeners(i),l.addSignupListeners(i)},l.addLoginListeners=function(a){var e=a.querySelector(".fanclub_login_form"),r=a.querySelector(".js_purchase_flow_login"),t=a.querySelector(".js_pf_login_username"),s=a.querySelector(".js_pf_login_password");r&&r.addEventListener("click",function(e){e.target&&!MG_Utils.hasClass(e.target,"disabled")&&(MG_Utils.addClass(e.target,"disabled"),l.requestLogin(a,e.target))}),e&&e.addEventListener("input",function(e){e.target&&MG_Utils.hasClass(e.target,"pf_login_input")&&t&&s&&""!=t.value&&""!=s.value&&!o.requireCaptcha&&r&&MG_Utils.removeClass(r,"disabled")}),e&&e.addEventListener("keyup",function(e){e.target&&MG_Utils.hasClass(e.target,"pf_login_input")&&"13"==e.keyCode&&!MG_Utils.hasClass(r,"disabled")&&(r&&MG_Utils.addClass(r,"disabled"),!e.target||"text"!=e.target.type&&"password"!=e.target.type||e.target.blur(),r&&l.requestLogin(a,r))})},l.requestLogin=function(a,r,t,s){try{null!=("undefined"==typeof CaptachaComponents?"undefined":_typeof(CaptachaComponents))&&CaptachaComponents.getCaptchaResponse().length&&l.handleLoginAjax(a,r,t,s)}catch(e){l.handleLoginAjax(a,r,t,s)}},l.addSignupListeners=function(t){l.signupInputs={email:t.querySelector(".js_pf_signup_email"),username:t.querySelector(".js_pf_signup_username"),password:t.querySelector(".js_pf_signup_password"),captcha_token:t.querySelector("#captcha_token")?t.querySelector("#captcha_token"):""},["keyup","input","keypress"].forEach(function(r){["email","username","password"].forEach(function(a){MG_Utils.addEventHandler(l.signupInputs[a],r,function(e){""!=e.target.value&&(l.signup_isInputValid(a,e.target,t)&&l.idleTimeoutValidation(function(){l.signup_backendCheckSetup(e.target,a,t)}),"keyup"!=r||"13"!=e.keyCode||MG_Utils.hasClass(t.querySelector(".js_purchase_flow_signup"),"disabled")||l.signup_submitAjax(t.querySelector(".js_purchase_flow_signup"),t))})})}),["email","username","password"].forEach(function(a){MG_Utils.addEventHandler(l.signupInputs[a],"focus",function(e){""!=e.target.value&&l.params.signup_errors[a]&&(t.querySelector(".fanclub_signup_form .error_message").innerHTML=l.params.signup_errors[a])})}),MG_Utils.addEventHandler(t.querySelector(".js_purchase_flow_signup"),"click",function(e){MG_Utils.hasClass(e.target,"disabled")||(MG_Utils.addClass(e.target,"disabled"),l.signup_submitAjax(e.target,t))})},l.handleLoginAjax=function(r,t,e,s){e=void 0!==e&&e,s=void 0!==s&&s,purchaseFlow_Utils.toggleLoading(r,t,"show");var i=!!t.hasAttribute("data-useDefaultFunctionality")&&"1"==t.getAttribute("data-useDefaultFunctionality"),a={token:l.params.token,username:r.querySelector(".js_pf_login_username").value,password:r.querySelector(".js_pf_login_password").value,remember_me:r.querySelector(".js_pf_login_remember").checked,modelId:t.getAttribute("data-model_id"),login:1,redirect:r.querySelector(".js_pf_login_redirect").value,pageUser:r.querySelector(".js_pf_login_pageUser").value};l.captchaResponse&&(a["g-recaptcha-response"]=l.captchaResponse),void 0!==l.params.couponCode&&l.params.couponCode&&(a.couponCode=l.params.couponCode),e&&(a=MG_Utils.extendSimple(a,e)),l.params.customExtraData&&(a=MG_Utils.extendSimple(a,l.params.customExtraData)),MG_Utils.ajaxCall({type:"POST",url:t.getAttribute("data-submit_url"),data:a,success:function(e){purchaseFlow_Utils.toggleLoading(r,t,"hide");var a;t.getAttribute("data-purchase_flow_type");MG_Utils.removeClassMultiple(r.querySelectorAll(".error_message"),"active"),MG_Utils.removeClassMultiple(r.querySelectorAll(".pf_login_input"),"error"),[].forEach.call(r.querySelectorAll(".error_message"),function(e){e.innerHTML=""}),void 0!==e.twoStepVerification&&e.twoStepVerification?(MG_Utils.addClass(r.querySelector(".pf_login_form"),"hide"),MG_Utils.addClass(r.querySelector(".pf_login_verification"),"active"),(a=r.querySelector(".pf_login_verification"))&&(a.querySelector(".loginPageVerificationEnabledUsername").value=e.username,a.querySelector(".verificationEnabledToken").value=e.autoLoginParameter,a.querySelector(".loginPageAuthyId").value=e.authyId,a.querySelector(".pf_verify_userNumber").innerText=e.phoneNumber),l.loginVerification_addListeners(r,a)):l.responseSuccessCheck(e)?(s?MG_Utils.addClass(r.querySelector(".pf_verify_message"),"active"):MG_Utils.addClass(r.querySelector(".fanclub_login_form .success_message"),"active"),i?l.doDefaultResponse(e):l.params.purchaseFlow&&l.params.purchaseFlow.handleAfterLoginSignup(r,e)):s?void 0!==e.message&&e.message&&(a=r.querySelector(".pf_login_verification"),MG_Utils.addClass(a.querySelector(".pf_verify_message_error"),"active"),a.querySelector(".pf_verify_message_error").innerText=e.message):(r.querySelector(".fanclub_login_form .error_message").innerHTML=e.message,MG_Utils.addClass(r.querySelector(".fanclub_login_form .error_message"),"active"),MG_Utils.addClassMultiple(r.querySelectorAll(".pf_login_input"),"error"),o.requireCaptcha=e.requireCaptcha,e.requireCaptcha&&(t.setAttribute("disabled","disabled"),MG_Utils.addClass(r.querySelector(".js_purchase_flow_login"),"disabled"),(e=r.querySelector(".fanclub_login_form .g-recaptcha"))&&null!=("undefined"==typeof CaptachaComponents?"undefined":_typeof(CaptachaComponents))&&(l.captchaResponse?CaptachaComponents.resetCaptcha():CaptachaComponents.registerComponent(e,function(e,a){l.captchaAcknowledgement(e,a,r,t)}))))}})},l.captchaAcknowledgement=function(e,a,r,t){if(e){var s=r.querySelector(".js_purchase_flow_login");switch(e){case"verified":l.captchaResponse=a,t.removeAttribute("disabled"),MG_Utils.removeClass(t,"disabled"),s&&MG_Utils.removeClass(s,"disabled");break;case"expired":case"error":MG_Utils.addClass(t,"disabled"),s&&MG_Utils.addClass(s,"disabled");break;default:return}}},l.loginVerification_addListeners=function(r,t){var s=t.querySelector(".pf_login_verificationCode");["keyup","input","keypress"].forEach(function(a){MG_Utils.addEventHandler(s,a,function(e){"input"==a&&0<s.value.length&&MG_Utils.removeClass(t.querySelector(".js_pfVerifySubmit"),"disabled"),"keyup"!=a||"13"!=e.keyCode||MG_Utils.hasClass(t.querySelector(".js_pfVerifySubmit"),"disabled")||l.loginVerification_submit(r,t,t.querySelector(".js_pfVerifySubmit")),0===s.value.length&&MG_Utils.addClass(t.querySelector(".js_pfVerifySubmit"),"disabled")})});var a=t.querySelector(".js_pfVerifySubmit");MG_Utils.addEventHandler(a,"click",function(e){MG_Utils.hasClass(a,"disabled")||l.loginVerification_submit(r,t,a)}),MG_Utils.addEventHandler(t.querySelector(".js_pfVerifyResendCode"),"click",function(e){t.querySelector(".pf_verify_resend_msg").innerText="",MG_Utils.removeClass(t.querySelector(".pf_verify_resend_msg"),"active"),MG_Utils.ajaxCall({type:"POST",data:{authyId:t.querySelector(".loginPageAuthyId").value,token:l.params.token},url:l.params.twoStepResendUrl,success:function(e){"success"==e.status?void 0!==e.message&&e.message&&(t.querySelector(".pf_verify_resend_msg").innerText=e.message,MG_Utils.addClass(t.querySelector(".pf_verify_resend_msg"),"active")):void 0!==e.message&&e.message&&(MG_Utils.addClass(t.querySelector(".pf_verify_message_error"),"active"),t.querySelector(".pf_verify_message_error").innerText=e.message)}})})},l.loginVerification_submit=function(e,a,r){a={username:a.querySelector(".loginPageVerificationEnabledUsername").value,token2:a.querySelector(".verificationEnabledToken").value,verification_modal:1,authyId:a.querySelector(".loginPageAuthyId").value,token:l.params.token,verification_code:a.querySelector(".pf_login_verificationCode").value};l.requestLogin(e,r,a,!0)},l.signup_backendCheckSetup=function(e,a,r){l.signup_ajaxCheck(e,a,e.value,r)},l.signup_hideError=function(e,a,r){MG_Utils.removeClass(e,"invalid"),l.params.signup_errors[a]&&delete l.params.signup_errors[a],0<Object.keys(l.params.signup_errors).length?r.querySelector(".fanclub_signup_form .error_message").innerHTML=l.params.signup_errors[Object.keys(l.params.signup_errors)[0]]:(MG_Utils.removeClass(r.querySelector(".fanclub_signup_form .error_message"),"active"),r.querySelector(".fanclub_signup_form .error_message").innerHTML="")},l.signup_ajaxCheck=function(a,r,e,t){var s={token:l.params.token,redirect:"",check_what:r};s[r]=e,MG_Utils.ajaxCall({type:"POST",url:l.params.checkInputAjax,data:s,success:function(e){""!==e.error_message?l.signup_putError(a,r,e.error_message,t):(l.signup_makeElementValid(a,r,t),l.signup_validateForm(t))},error:function(){console.log("Network Error!")}})},l.idleTimeoutValidation=function(e){l.params.timer&&clearTimeout(l.params.timer),l.params.timer=setTimeout(function(){e()},l.params.idleTime)},l.signup_isInputValid=function(e,a,r){switch(e){case"email":return l.signup_isEmailValid(a,r);case"username":return l.signup_isUsernameValid(a,r);case"password":return l.signup_isPasswordValid(a,r)}},l.signup_isEmailValid=function(e,a){return/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\]|(\[ipv6:)((?:[A-F0-9]{1,4}:){4,}[A-F0-9]{1,4})])/gim.test(e.value)?e.value.length<5?(l.signup_putError(e,"email",l.params.errorMsg.emailTooShort,a),!1):!(254<e.value.length)||(l.signup_putError(e,"email",l.params.errorMsg.emailTooLong,a),!1):(l.signup_putError(e,"email",l.params.errorMsg.invalidEmail,a),!1)},l.signup_isUsernameValid=function(e,a){var r=a.querySelector(".js_pf_signup_password");return e.value.length<5?(l.signup_putError(e,"username",l.params.errorMsg.usernameTooShort,a),!1):18<e.value.length?(l.signup_putError(e,"username",l.params.errorMsg.usernameTooLong,a),!1):""==r.value||r.value!=e.value||(l.signup_putError(e,"username",l.params.errorMsg.usernamePasswordcantMatch,a),!1)},l.signup_isPasswordValid=function(e,a){var r=a.querySelector(".js_pf_signup_username");return e.value.length<6?(l.signup_putError(e,"password",l.params.errorMsg.passwordTooShort,a),!1):40<e.value.length?(l.signup_putError(e,"password",l.params.errorMsg.passwordTooLong,a),!1):""==r.value||r.value!=e.value||(l.signup_putError(e,"password",l.params.errorMsg.usernamePasswordcantMatch,a),!1)},l.signup_putError=function(e,a,r,t){r=void 0!==r?r:"",MG_Utils.addClass(t.querySelector(".js_purchase_flow_signup"),"disabled"),MG_Utils.removeClass(e,"valid"),MG_Utils.addClass(e,"invalid"),e.setAttribute("data-valid",!1),(l.params.signup_errors[a]=r)?(t.querySelector(".fanclub_signup_form .error_message").innerHTML=r,MG_Utils.addClass(t.querySelector(".fanclub_signup_form .error_message"),"active")):l.signup_getError(a,t)},l.signup_getError=function(e,a){l.params.signup_errors[e]&&(a.querySelector(".fanclub_signup_form .error_message").innerHTML=l.params.signup_errors[e],a.querySelector(".fanclub_signup_form .error_message").style.opacity=1)},l.signup_makeElementValid=function(e,a,r){MG_Utils.removeClass(e,"invalid"),MG_Utils.addClass(e,"valid"),e.setAttribute("data-valid",!0),l.signup_hideError(e,a,r)},l.signup_validateForm=function(e){var a=!1;(a="true"==e.querySelector(".js_pf_signup_email").getAttribute("data-valid")&&"true"==e.querySelector(".js_pf_signup_username").getAttribute("data-valid")&&"true"==e.querySelector(".js_pf_signup_password").getAttribute("data-valid")?!0:a)?MG_Utils.removeClass(e.querySelector(".js_purchase_flow_signup"),"disabled"):MG_Utils.addClass(e.querySelector(".js_purchase_flow_signup"),"disabled")},l.signup_submitAjax=function(r,t){purchaseFlow_Utils.toggleLoading(t,r,"show");var s=!!r.hasAttribute("data-useDefaultFunctionality")&&"1"==r.getAttribute("data-useDefaultFunctionality"),e={token:l.params.token,"g-recaptcha-response":l.captchaResponse,email:l.signupInputs.email.value,username:l.signupInputs.username.value,password:l.signupInputs.password.value,modelId:r.getAttribute("data-model_id"),signup:1,pageUser:t.querySelector(".js_pf_signup_pageUser").value};void 0!==l.params.couponCode&&l.params.couponCode&&(e.couponCode=l.params.couponCode),s&&(e.format="json"),l.params.customExtraData&&(e=MG_Utils.extendSimple(e,l.params.customExtraData)),MG_Utils.ajaxCall({type:"POST",url:r.getAttribute("data-submit_url"),data:e,success:function(e){var a;purchaseFlow_Utils.toggleLoading(t,r,"hide"),l.responseSuccessCheck(e)?s?l.doDefaultResponse(e):l.params.purchaseFlow&&l.params.purchaseFlow.handleAfterLoginSignup(t,e):("2"===e.success||(a=t.querySelector(".fanclub_signup_form .error_message"))&&(a.innerHTML=e.message,a.style.display="block"),a=!0,(a="FAIL"==e.success&&!e.showSignupCaptcha?!1:a)&&(o.requireCaptcha=!0,r.setAttribute("disabled","disabled"),(a=t.querySelector(".fanclub_signup_form .g-recaptcha"))&&null!=("undefined"==typeof CaptachaComponents?"undefined":_typeof(CaptachaComponents))&&(l.captchaResponse?CaptachaComponents.resetCaptcha():CaptachaComponents.registerComponent(a,function(e,a){l.captchaAcknowledgement(e,a,t,r)}))))}})},l.responseSuccessCheck=function(e){return void 0!==e.success?"PASS"==e.success||"1"===e.success:void 0!==e.responseData&&"1"===e.responseData.success},l.setLoginSignupAjaxUrl=function(e,a){e=e.querySelector(".login_signup_modal");e&&(e=e.querySelectorAll(".jsLoginSignupUrl"),[].forEach.call(e,function(e){e&&e.setAttribute("data-submit_url",a)}))},l.useDefaultFunctionality=function(e){var a=e.querySelector(".js_purchase_flow_login"),r=e.querySelector(".js_purchase_flow_signup"),e=e.querySelector(".js_pfVerifySubmit");a&&(a.setAttribute("data-submit_url",l.params.defaultLoginUrl),a.setAttribute("data-useDefaultFunctionality","1")),e&&(e.setAttribute("data-submit_url",l.params.defaultLoginUrl),e.setAttribute("data-useDefaultFunctionality","1")),r&&(r.setAttribute("data-submit_url",l.params.defaultSignupUrl),r.setAttribute("data-useDefaultFunctionality","1"))},l.doDefaultResponse=function(e){(e.expiredPremiumUser||e.forceRedirect||e.autoLoginParameter)&&e.redirect?window.location.href=e.redirect:window.location.reload(!0)}};try{var purchaseFlow_LoginSignup=new PurchaseFlow_LoginSignup;purchaseFlow_LoginSignup.init("undefined"!=typeof purchaseFlow_LoginSignup_Params?purchaseFlow_LoginSignup_Params:{}),PurchaseFlow_LoginSignup.requireCaptcha=!1}catch(e){console.log("ERROR === Login / Signup Modal ==="),console.log(e)}
var TippingPurchaseFlow=function(){"use strict";var n=this;n.defaultSettings={showSuccessModal:!1,showFailureModal:!1,dismissUrl:"",tipButton_Class:"js-tipsTrigger",triggerPurchaseFlow:!1,submodal_class:".tipping_submodal",showSignupCaptcha:!1,modelUsername:"",vkey:!1,dynamicallyTargetButton:!1,modelId:"",trackingDataHash:null,isLiveStreamingWatchPage:!1,liveStreamingVkey:null},n.init=function(e){n.params=MG_Utils.extendSimple(n.defaultSettings,e),n.initModals(),n.add_listeners()},n.initModals=function(){n.purchaseFlowModal=new MG_Modal({closeButton:!1,closeDocument:!1,content:document.querySelector(".tipping_modals_container"),className:"tippingPurchaseFlowModal purchaseFlowModal",lazyload:!0})},n.add_listeners=function(){var e,a,t;n.params.dynamicallyTargetButton?MG_Utils.addEventHandler(document,"click",function(e){var a,t;e.target&&(t=(a=e.target.parentNode)?a.parentNode:null,MG_Utils.hasClass(e.target,n.params.tipButton_Class)?n.buttonTriggerModal(e.target):a&&MG_Utils.hasClass(a,n.params.tipButton_Class)?n.buttonTriggerModal(a):t&&MG_Utils.hasClass(t,n.params.tipButton_Class)&&n.buttonTriggerModal(t))}):(t=document.querySelectorAll("."+n.params.tipButton_Class),[].forEach.call(t,function(a){MG_Utils.addEventHandler(a,"click",function(e){a.getAttribute("data-model")&&n.buttonTriggerModal(a)})})),("#tip"===window.location.hash||0<window.location.search.indexOf("sendTip=1"))&&n.params.isModelPage&&(n.params.redirectToMH&&n.params.modelhubUrl?window.location.href=n.params.PHredirectToMHUrl+"?url="+n.params.modelhubUrl+"?sendTip=1":purchaseFlow_Utils.noAgeModal(n.params)&&n.triggerPurchaseFlow(n.params.modelUsername,n.params.modelId)),n.params.showSuccessModal&&(n.params.useSuccessSnackBar?(e=document.querySelector(".pfSuccessBar.tip"))&&(MG_Utils.addClass(e,"active"),n.params.redirectWithoutParamsUrl&&window.history.pushState("","",n.params.redirectWithoutParamsUrl),setTimeout(function(){MG_Utils.removeClass(e,"active")},3e3)):purchaseFlow_Utils.openSuccessModal(".modalMTubes.tippingPurchaseFlowModal",n.params,n.purchaseFlowModal)),n.params.showFailureModal&&(n.purchaseFlowModal.openModal(),a=document.querySelector(".modalMTubes.tippingPurchaseFlowModal"),purchaseFlow_Utils.openSelectedModal(".pf_failure_modal",a),MG_Utils.addClass(a,"redirect_on_close"),purchaseFlow_Utils.addModalCloseListeners(a,n.params,n.purchaseFlowModal),t=purchaseFlow_Utils.getCurrentOpenedModal(a,!0).querySelector(".js_retryPurchase"),n.params.selectedTipAmount=n.params.transactionTipAmount,purchaseFlow_Utils.addFailureModalTryAgainListener(a,t,n.params.sendTipUrl,n.getAjaxData(!0)))},n.buttonTriggerModal=function(e){n.params.redirectToMH?n.params.isLiveStreamingWatchPage?n.params.modelhubUrl&&window.open(n.params.PHredirectToMHUrl+"?url="+encodeURIComponent(n.params.modelhubUrl+"?sendTip=1&trackingHash="+n.params.trackingDataHash),"_blank"):e.getAttribute("data-mh_url")&&(window.location.href=n.params.PHredirectToMHUrl+"?url="+e.getAttribute("data-mh_url")+"?sendTip=1"):(e.getAttribute("data-trackingLocationTab")&&(n.params.trackingLocationTab=e.getAttribute("data-trackingLocationTab")),n.triggerPurchaseFlow(e.getAttribute("data-model"),e.getAttribute("data-model_id")))},n.addNewEventHandlers=function(i){n.addTippingModalListeners(i),purchaseFlow_Utils.addModalCloseListeners(i,n.params,n.purchaseFlowModal),purchaseFlow_Utils.addLeaveModalListeners(i,n.params,n.purchaseFlowModal),[].forEach.call(i.querySelectorAll(".js_changeCC"),function(t){MG_Utils.addEventHandler(t,"click",function(){var e,a;MG_Utils.hasClass(t,"disabled")||(e=!0,"js-tipsModal"==purchaseFlow_Utils.getCurrentOpenedModal(i)&&(a=i.querySelector('.tips .inputBox input[type="radio"]:checked'),MG_Utils.hasClass(a,"js-tipOther")&&(e=n.validateTipValue(i)),a&&(n.params.selectedTipAmount=a.getAttribute("data-value"))),e&&n.sendTipsAjax(i,!0))})});var e=i.querySelectorAll(".complianceAddress.desktopOnly");e&&[].forEach.call(e,function(e){a(e,"MG Billing US Corp, 2300 Empire Avenue, 7th Floor, Burbank, CA 91504, USA\nMG Billing Limited, 195-197 Old Nicosia-Limassol Road, Dali Industrial Zone 2540, Block 1, Cyprus")});e=i.querySelectorAll(".complianceAddress.mobileOnly");function a(e,a){var t=e.getContext("2d"),e=e.width/2;t.font="10px Arial",t.fillStyle="#9B9B9B",t.textAlign="center",function(e,a,t,i){for(var s=a.split("\n"),r=0;r<s.length;++r)e.fillText(s[r],t,i),i+=12}(t,a,e,10)}e&&[].forEach.call(e,function(e){a(e,"MG Billing US Corp, 2300 Empire Avenue, 7th Floor, Burbank,\nCA 91504, USA\nMG Billing Limited, 195-197 Old Nicosia-Limassol Road,\nDali Industrial Zone 2540, Block 1, Cyprus")})},n.addTippingModalListeners=function(a){var e=a.querySelector(".js-tipsModal"),t=e.querySelectorAll(".inputBox"),i=e.querySelector(".js_tippingModalCheckout"),s=e.querySelector(".js_changeCC");[].forEach.call(t,function(a){MG_Utils.addEventHandler(a,"click",function(e){MG_Utils.hasClass(a,"other")||(i&&MG_Utils.removeClass(i,"disabled"),s&&MG_Utils.removeClass(s,"disabled"))})}),i&&i.addEventListener("click",function(e){e.preventDefault(),n.submitTippingModal(a)});var r=e.querySelector(".js-tipOther"),t=e.querySelectorAll("input.tipRadio"),l=e.querySelector(".tipOtherCaption").querySelector(".inputTipOther");[].forEach.call(t,function(a){a.addEventListener("change",function(e){a.checked&&(l.value="",MG_Utils.removeClass(l,"error"))})}),l&&l.addEventListener("keydown",function(e){13==e.keyCode&&(e.preventDefault(),n.submitTippingModal(a))}),l&&l.addEventListener("input",function(e){var a=l.value;0<a.length?(r.checked=!0,i&&MG_Utils.removeClass(i,"disabled"),s&&MG_Utils.removeClass(s,"disabled"),r&&r.setAttribute("data-value",a)):0==a.length&&(i&&MG_Utils.addClass(i,"disabled"),s&&MG_Utils.addClass(s,"disabled")),MG_Utils.removeClass(l,"error")})},n.triggerPurchaseFlow=function(a,t){n.purchaseFlowModal.openModal(function(){var e=document.querySelector(".modalMTubes.tippingPurchaseFlowModal");purchaseFlow_Utils.openSelectedModal(".js-tipsModal",e),n.params.modelUsername=a,n.params.modelId=t,e.innerHTML=e.innerHTML.replace(/MODEL_ID/g,t),n.addNewEventHandlers(e),[].forEach.call(e.querySelectorAll(".tippedModel"),function(e){e.innerHTML=n.params.modelUsername})})},n.submitTippingModal=function(e){var a=e.querySelector(".js_tippingModalCheckout");!MG_Utils.hasClass(a,"disabled")&&n.validateTipValue(e)&&(n.params.selectedTipAmount=e.querySelector('.tips .inputBox input[type="radio"]:checked').getAttribute("data-value"),[].forEach.call(e.querySelectorAll(".modelTipAmount"),function(e){e.innerHTML=n.params.selectedTipAmount}),n.params.liu?(n.params.last4?(purchaseFlow_Utils.openSelectedModal(".js-tipsDigits",e),n.addLastDigitEventListeners(e)):(MG_Utils.addClass(a,"disabled"),n.sendTipsAjax(e,!1,!1,a)),MG_Utils.addClass(e,"leave_confirmation")):(purchaseFlow_Utils.openSelectedModal(".login_signup_modal",e),purchaseFlow_LoginSignup&&(purchaseFlow_LoginSignup.params.customExtraData=n.getExtraLoginSignupData(),purchaseFlow_LoginSignup.addListeners(e,tippingPurchaseFlow))))},n.validateTipValue=function(e){var a=e.querySelector(".js-tipsModal"),t=a.querySelector(".js_tippingModalCheckout"),i=a.querySelector(".js_changeCC"),s=!0,r=a.querySelector('.inputBox input[type="radio"]:checked');if(r){var l=r.parentElement;return MG_Utils.hasClass(r,"js-tipOther")&&(e=l.querySelector(".inputTipOther").value,(s=!!/^\d+$/.test(e)&&(0<(a=parseInt(e))&&a<=150))?(MG_Utils.removeClass(l.querySelector(".inputTipOther"),"error"),r.setAttribute("data-value",e)):(MG_Utils.addClass(l.querySelector(".inputTipOther"),"error"),l.querySelector(".inputTipOther").value="",t&&MG_Utils.addClass(t,"disabled"),i&&MG_Utils.addClass(i,"disabled"))),s}return!1},n.handleAfterLoginSignup=function(e,a){var t;void 0!==a.liuIsOwner&&a.liuIsOwner?window.location.reload(!0):(void 0!==a.newToken&&a.newToken&&(n.params.token=a.newToken),void 0!==a.last4Required&&a.last4Required?(purchaseFlow_Utils.openSelectedModal(".js-tipsDigits",e),n.addLastDigitEventListeners(e,a)):(n.sendTipsAjax(e,!1,!1),void 0===a.first6||!a.first6||(t=e.querySelectorAll(".js-oneClickChangeCC"))&&MG_Utils.removeClassMultiple(t,"displayNone")),MG_Utils.addClass(e,"leave_confirmation"),MG_Utils.addClass(e,"reload_on_close"),void 0!==a.dismissUrl&&(n.params.dismissUrl=a.dismissUrl),void 0!==a.al&&(n.params.premiumUserInfo=a.al),void 0===a.hasCreditCardSaved||a.hasCreditCardSaved||MG_Utils.addClassMultiple(e.querySelectorAll(".changeCCSection"),"displayNone"))},n.sendTipsAjax=function(t,e,i,s){e=void 0!==e&&e,i=void 0!==i&&i,s=void 0!==s&&s;var r,l=purchaseFlow_Utils.getCurrentOpenedModal(t,!0);s&&purchaseFlow_Utils.toggleLoading(t,s,"show"),!i||(r=l.querySelectorAll(".lastFour"))&&[].forEach.call(r,function(e){e.disabled=!0});var o=n.getAjaxData(e,i);MG_Utils.ajaxCall({url:n.params.sendTipUrl,type:"POST",data:o,success:function(e){var a=l.querySelector(".js_sendTipError");purchaseFlow_Utils.showCreditCardModal(e)?purchaseFlow_Utils.setupCreditCardModal(t,n.params.sendTipUrl,parseFloat(n.params.selectedTipAmount).toFixed(2),o):e.error?(a&&(a.innerHTML=e.message),i&&(a&&MG_Utils.addClass(a,"active"),s&&MG_Utils.removeClass(s,"disabled"),r&&[].forEach.call(r,function(e){e.value="",e.disabled=!1})),s&&purchaseFlow_Utils.toggleLoading(t,s,"hide")):(e.MixpanelEvent&&"undefined"!=typeof mixpanel&&mixpanel.track(e.MixpanelEvent.eventName,e.MixpanelEvent.event),a&&(a.innerHTML=""),i&&a&&MG_Utils.removeClass(a,"active"),window.location.href=e.redirectUrl)}})},n.getAjaxData=function(e,a){e=void 0!==e&&e,a=void 0!==a&&a;var t={amount:n.params.selectedTipAmount,username:n.params.modelUsername,token:n.params.token,modelId:n.params.modelId};return n.params.viewkey&&(t.viewkey=n.params.viewkey),n.params.premiumUserInfo&&(t.al=n.params.premiumUserInfo),e&&(t.newCC=1),a&&(t.last4=a),n.params.isChat&&(t.isChat=1),n.params.trackingSourcePage&&(t.source_page=n.params.trackingSourcePage),n.params.trackingLocationTab&&(t.location_tab=n.params.trackingLocationTab),n.params.isLiveStreamingWatchPage&&(t.isLiveStreamingWatchPage=n.params.isLiveStreamingWatchPage),n.params.liveStreamingVkey&&(t.liveStreamingVkey=n.params.liveStreamingVkey),n.params.trackingDataHash&&(t.trackingHash=n.params.trackingDataHash),t},n.getExtraLoginSignupData=function(){var e={};return n.params.trackingDataHash&&(e.trackingHash=n.params.trackingDataHash),n.params.isLiveStreamingWatchPage&&(e.isLiveStreamingWatchPage=n.params.isLiveStreamingWatchPage),n.params.liveStreamingVkey&&(e.liveStreamingVkey=n.params.liveStreamingVkey),e},n.addLastDigitEventListeners=function(e,a){a=void 0!==a&&a;var t=purchaseFlow_Utils.getCurrentOpenedModal(e,!0),i=t.querySelector(".jsLastDigitsSubmit");pfLast4.init(e,tippingPurchaseFlow,a),i&&i.addEventListener("click",function(){MG_Utils.hasClass(i,"disabled")||(MG_Utils.addClass(i,"disabled"),n.sendTipsAjax(e,!1,pfLast4.getLast4(t),i))})},n.handleLastDigitsAjax=function(e,a,t,i){n.sendTipsAjax(e,!1,t,i)}};try{var tippingPurchaseFlow=new TippingPurchaseFlow;tippingPurchaseFlow.init("undefined"!=typeof Tipping_PurchaseFlow_Params?Tipping_PurchaseFlow_Params:{})}catch(e){console.log("ERROR === Tipping Purchase Flow ==="),console.log(e)}
var VideoPurchaseFlow=function(){"use strict";var t=this;t.defaultSettings={showSuccessModal:!1,showFailureModal:!1,dismissUrl:"",buyVideoButton:".js-purchaseButton",submodal_class:".videoPurchase_submodal",showSignupCaptcha:!1},t.init=function(e){t.params=MG_Utils.extendSimple(t.defaultSettings,e),t.initModals(),t.add_listeners()},t.initModals=function(){t.purchaseFlowModal=new MG_Modal({closeButton:!1,closeDocument:!1,content:document.querySelector(".video_purchase_modals_container"),className:"videoPurchaseFlowModal purchaseFlowModal",lazyload:!0})},t.add_listeners=function(){var e,a=document.querySelectorAll(t.params.buyVideoButton);[].forEach.call(a,function(a){MG_Utils.addEventHandler(a,"click",function(e){t.params.redirectToMH?window.location.href=t.params.PHredirectToMHUrl+"?url=https://www.modelhub.com/video/"+t.params.vkey:(a.getAttribute("data-trackingLocationTab")&&(t.params.trackingLocationTab=a.getAttribute("data-trackingLocationTab")),t.triggerPurchaseFlow())})}),t.params.showSuccessModal&&purchaseFlow_Utils.openSuccessModal(".modalMTubes.videoPurchaseFlowModal",t.params,t.purchaseFlowModal,function(e){ga("send","event","Success Modal","click","Click on modal")}),t.params.showFailureModal&&(t.purchaseFlowModal.openModal(),e=document.querySelector(".modalMTubes.videoPurchaseFlowModal"),purchaseFlow_Utils.openSelectedModal(".pf_failure_modal",e),MG_Utils.addClass(e,"redirect_on_close"),purchaseFlow_Utils.addModalCloseListeners(e,t.params,t.purchaseFlowModal),a=purchaseFlow_Utils.getCurrentOpenedModal(e,!0).querySelector(".js_retryPurchase"),purchaseFlow_Utils.addFailureModalTryAgainListener(e,a,t.params.tryAgainUrl,t.getAjaxData(!1,1)),ga("send","event","Transaction Failed Modal","click","Modal Shown"))},t.triggerPurchaseFlow=function(){t.purchaseFlowModal.openModal(function(){var e,a=document.querySelector(".modalMTubes.videoPurchaseFlowModal");t.params.last4?(purchaseFlow_Utils.openSelectedModal(".js-purchaseDigitsModal",a),t.addLastDigitEventListeners(a)):(purchaseFlow_Utils.openSelectedModal(".js-purchaseModal",a),(e=purchaseFlow_Utils.getCurrentOpenedModal(a,!0)).addEventListener("click",function(e){e=e.target;e&&MG_Utils.hasClass(e,"js-purchaseVideoButton")&&(e.setAttribute("disabled",!0),t.params.liu?t.probillerAjax(a,t.params.probillerUrl,e):(purchaseFlow_Utils.openSelectedModal(".login_signup_modal",a),purchaseFlow_LoginSignup&&(purchaseFlow_LoginSignup.params.customExtraData=t.getExtraLoginSignupData(),purchaseFlow_LoginSignup.addListeners(a,videoPurchaseFlow))))}),purchaseFlow_Utils.addChangeCCListeners(e,t.params.probillerCreditCard,!0,videoPurchaseFlow)),purchaseFlow_Utils.addModalCloseListeners(a,t.params,t.purchaseFlowModal),purchaseFlow_Utils.addLeaveModalListeners(a,t.params,t.purchaseFlowModal),purchaseFlow_Utils.setupCouponCode(a,videoPurchaseFlow)})},t.probillerAjax=function(a,e,o){var r=purchaseFlow_Utils.getCurrentOpenedModal(a,!0).querySelector(".jsBuyVideoError");purchaseFlow_Utils.toggleLoading(a,o,"show"),MG_Utils.addClass(o,"disabled"),MG_Utils.ajaxCall({url:e,type:"POST",data:t.getAjaxData(),success:function(e){purchaseFlow_Utils.showCreditCardModal(e)?(t.setupCreditCardPriceLabels(a),purchaseFlow_Utils.setupCreditCardModal(a,t.params.probillerUrl,t.params.price,t.getAjaxData())):"FAIL"==e.success||e.error?(r.innerHTML=e.message,purchaseFlow_Utils.toggleLoading(a,o,"hide"),o.removeAttribute("disabled")):(r.innerHTML="","undefined"!=typeof mixpanel&&(mixpanel.identify(e.MixpanelEvent.userId),mixpanel.track(e.MixpanelEvent.eventName,e.MixpanelEvent.event)),window.location.href=e.redirectUrl)}})},t.handleAfterLoginSignup=function(e,a){var o;void 0!==a.liuIsOwner&&a.liuIsOwner?window.location.reload(!0):(MG_Utils.removeClass(e,"leave_confirmation"),MG_Utils.addClass(e,"reload_on_close"),void 0!==a.newToken&&a.newToken&&(t.params.token=a.newToken),void 0!==a.dismissUrl&&(t.params.dismissUrl=a.dismissUrl),void 0!==a.al&&(t.params.premiumUserInfo=a.al),void 0!==a.last4Required&&a.last4Required?(purchaseFlow_Utils.openSelectedModal(".videoPurchaseDigitsModal",e),t.addLastDigitEventListeners(e,a),o=t.params.couponCode,purchaseFlow_Utils.setupCouponCode(e,videoPurchaseFlow),o&&couponCodeModule.applyCoupon(o)):void 0!==a.alreadyBought&&a.alreadyBought?(purchaseFlow_Utils.openSelectedModal(".js-alreadyBoughtModal",e),void 0!==a.profileUrl&&e.querySelector(".js_alreadyBought").setAttribute("data-url",a.profileUrl),MG_Utils.addEventHandler(e.querySelector(".js_alreadyBought"),"click",function(e){t.purchaseFlowModal.closeModal(function(){window.location.href=e.target.getAttribute("data-url")})})):purchaseFlow_Utils.showCreditCardModal(a)?(t.setupCreditCardPriceLabels(e,e.querySelector(".videoPurchaseModal")),purchaseFlow_Utils.setupCreditCardModal(e,t.params.probillerUrl,t.params.price,t.getAjaxData())):void 0!==a.redirectUrl&&(window.location.href=a.redirectUrl))},t.addLastDigitEventListeners=function(e,a){a=void 0!==a&&a;var o=purchaseFlow_Utils.getCurrentOpenedModal(e,!0),r=o.querySelector(".jsLastDigitsSubmit");pfLast4.init(e,videoPurchaseFlow,a),r&&r.addEventListener("click",function(){MG_Utils.hasClass(r,"disabled")||(MG_Utils.addClass(r,"disabled"),t.handleLastDigitsAjax(e,o,pfLast4.getLast4(o),r))}),purchaseFlow_Utils.addChangeCCListeners(o,t.params.probillerCreditCard,!0,videoPurchaseFlow)},t.handleLastDigitsAjax=function(a,e,o,r){purchaseFlow_Utils.toggleLoading(a,r,"show");var s=e.querySelector(".pfLastDigitsError");s&&(MG_Utils.removeClass(s,"active"),s.innerHTML=""),MG_Utils.ajaxCall({type:"POST",data:t.getAjaxData(o),url:t.params.probillerUrl,success:function(e){"FAIL"==e.success||e.error?(s&&(MG_Utils.addClass(s,"active"),s.innerHTML=e.message),purchaseFlow_Utils.toggleLoading(a,r,"hide"),r&&MG_Utils.removeClass(r,"disabled")):window.location.href=e.redirectUrl}})},t.getAjaxData=function(e,a){e=void 0!==e&&e,a=void 0!==a&&a;var o={};return t.params.token&&(o.token=t.params.token),t.params.premiumUserInfo&&(o.al=t.params.premiumUserInfo),e&&(o.last4=e),t.params.couponCode&&(o.couponCode=t.params.couponCode),a&&(o.tryAgain=a),t.params.trackingSourcePage&&(o.source_page=t.params.trackingSourcePage),t.params.trackingLocationTab&&(o.location_tab=t.params.trackingLocationTab),o},t.getExtraLoginSignupData=function(){var e={};return t.params.trackingSourcePage&&(e.source_page=t.params.trackingSourcePage),t.params.trackingLocationTab&&(e.location_tab=t.params.trackingLocationTab),e},t.setupCreditCardPriceLabels=function(e,a){a=void 0!==a?a:purchaseFlow_Utils.getCurrentOpenedModal(e,!0);e=e.querySelector(".pfCreditCardModal"),a=!!a&&a.querySelector(".js-pfPurchasePrice").cloneNode(!0);e&&a&&((e=a.querySelector(".strikethrough"))&&a.getAttribute("data-percent"),e&&a.removeChild(e),a=a.innerText.replace(/\s/g,""),"v1"==CREDIT_CARD_FORM.version&&(t.params.price=a))}};try{var videoPurchaseFlow=new VideoPurchaseFlow;videoPurchaseFlow.init("undefined"!=typeof Video_PurchaseFlow_Params?Video_PurchaseFlow_Params:{})}catch(e){console.log("ERROR === Video Purchase Flow ==="),console.log(e)}
function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).CreditCard=e()}(function(){return function n(i,o,u){function a(t,e){if(!o[t]){if(!i[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(l)return l(t,!0);throw(r=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",r}r=o[t]={exports:{}},i[t][0].call(r.exports,function(e){return a(i[t][1][e]||e)},r,r.exports,n,i,o,u)}return o[t].exports}for(var l="function"==typeof require&&require,e=0;e<u.length;e++)a(u[e]);return a}({1:[function(e,t,r){"use strict";var n=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e};function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=e("./creditCardList"),u=e("./helpers/luhn"),n=(n(a,[{key:"retrieveCreditCardList",value:function(){return this.creditcardlist.retrieveCreditCardList()}},{key:"isValid",value:function(e){return this.luhn.isValid(e)}},{key:"getCreditCardNameByNumber",value:function(e){for(var t=this.retrieveCreditCardList(),r=0;r<t.length;r++){var n=t[r];if(n.regexpFull.test(e))return n.name}return"Credit card is invalid!"}},{key:"isSecurityCodeValid",value:function(e,t){e=this.getCreditCardNameByNumber(e);return new RegExp("^[0-9]{"+("Amex"===e?4:3)+"}$").test(t)}},{key:"isExpirationDateValid",value:function(e,t){var r=parseInt(e,10),n=parseInt(t,10),e=(new Date).getFullYear(),t=(new Date).getMonth()+1;return!isNaN(r)&&!isNaN(n)&&(!(n===e&&r<t)&&(!(r<1||12<r)&&!(n<1e3||3e3<=n)))}}]),a);function a(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),this.creditcardlist=new o,this.luhn=new u}t.exports=n},{"./creditCardList":2,"./helpers/luhn":3}],2:[function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=[{name:"Elo",regexpFull:/^(401178|401179|431274|438935|451416|457393|457631|457632|504175|627780|636297|636368|(506699|5067[0-6]\d|50677[0-8])|(50900\d|5090[1-9]\d|509[1-9]\d{2})|65003[1-3]|(65003[5-9]|65004\d|65005[0-1])|(65040[5-9]|6504[1-3]\d)|(65048[5-9]|65049\d|6505[0-2]\d|65053[0-8])|(65054[1-9]|6505[5-8]\d|65059[0-8])|(65070\d|65071[0-8])|65072[0-7]|(65090[1-9]|65091\d|650920)|(65165[2-9]|6516[6-7]\d)|(65500\d|65501\d)|(65502[1-9]|6550[3-4]\d|65505[0-8]))[0-9]{10,12}/},{name:"Diners",regexpFull:/^3(?:0[0-5]|[68][0-9])[0-9]{11}$/},{name:"Discover",regexpFull:/^6(?:011|5[0-9]{2}|4[4-9][0-9]{1}|(22(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[01][0-9]|92[0-5]$)[0-9]{10}$))[0-9]{12}$/},{name:"Hipercard",regexpFull:/^(38[0-9]{17}|60[0-9]{14})$/},{name:"Amex",regexpFull:/^3[47][0-9]{13}$/},{name:"Aura",regexpFull:/^50[0-9]{14,17}$/},{name:"Mastercard",regexpFull:/^(5[1-5][0-9]{14}|2221[0-9]{12}|222[2-9][0-9]{12}|22[3-9][0-9]{13}|2[3-6][0-9]{14}|27[01][0-9]{13}|2720[0-9]{12})$/},{name:"Visa",regexpFull:/^4[0-9]{12}(?:[0-9]{3})?$/},{name:"JCB",regexpFull:/^(?:(?:2131|1800|35\d{3})\d{11})$/}],o=(function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}(u,[{key:"retrieveCreditCardList",value:function(){return this.list}}]),u);function u(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),this.list=i}t.exports=o},{}],3:[function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=(function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}(o,[{key:"_sum",value:function(e){for(var t,r=0,n=e.length,i=!0;n--;)t=Number(e[n]),r+=(i=!i)?this.computed[t]:t;return r}},{key:"isValid",value:function(e){if(new RegExp("/[^0-9-s]+/").test(e))return!1;e=e.replace(/\D/g,""),e=this._sum(e);return 0<e&&e%10==0}}]),o);function o(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.computed=[0,2,4,6,8,1,3,5,7,9]}t.exports=i},{}]},{},[1])(1)});
function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var CC_GLOBAL={},cc_setGlobalVariables=function(e,t){e=void 0!==e?e:document,CC_GLOBAL={container:e,version:t,form:e.querySelector(".creditCardForm"),expiryYearField:e.querySelector(".expiryYear"),expiryMonthField:e.querySelector(".expiryMonth"),paymentLoader:e.querySelector(".paymentLoader"),expiryContainer:e.querySelector(".floatExpiryDate"),error_expiryDateElm:e.querySelector(".error_expiryDate"),error_securityCodeElm:e.querySelector(".error_securityCode"),cardNumberInput:e.querySelector(".cardNumber"),firstnameInput:e.querySelector(".firstName"),lastnameInput:e.querySelector(".lastName"),cvvInput:e.querySelector(".securityCode"),zipInput:e.querySelector(".zipCode")}},GLOBAL_PB_MONITORING={purchaseType:"",purchaseUUID:""},creditCardModule=function(){function s(e){e={uuid:CREDIT_CARD_MODAL.apiPornhubUUID||"",response:e};void 0!==CREDIT_CARD_MODAL.premiumUserInfo&&CREDIT_CARD_MODAL.premiumUserInfo&&(e.al=CREDIT_CARD_MODAL.premiumUserInfo),MG_Utils.ajaxCall({type:"POST",url:CREDIT_CARD_MODAL.validationUrl,data:e,success:function(e){var t;1!==e.success&&e.error||!e.redirectUrl?(e.messages&&(e.messages.general?n(e.messages.general):n(CC_VALIDATION_MESSAGES.validationError)),CC_GLOBAL.paymentLoader&&MG_Utils.addClass(CC_GLOBAL.paymentLoader,"displayNone")):(LocalStorageManager.getInstance().get("dataProductID")&&LocalStorageManager.getInstance().remove("dataProductID"),(t=e).pornhubUUID?MG_Utils.ajaxCall({type:"POST",url:WIDGET_PREMIUM_SIGNUP.legacyPbTrackingUrl,requestType:"text/json; charset=UTF-8",data:{pornhubUUID:t.pornhubUUID,redirect:t.redirect||"",success:t.success||"",user:t.user||"",username:t.username||"",message:t.message||"",entry:"web/cdn_files/js/purchase/credit_card_form.js line 162"},success:function(){window.location.href=t.redirectUrl}}):window.location.href=t.redirectUrl)},error:function(){CC_GLOBAL.paymentLoader&&MG_Utils.addClass(CC_GLOBAL.paymentLoader,"displayNone"),console.log("Error in payment validation")}})}function i(){var e,t="v2"==CC_GLOBAL.version?(e=creditCardV2.getCleanedExpiryValue(CC_GLOBAL.expiryYearField,"year",!0),creditCardV2.getCleanedExpiryValue(CC_GLOBAL.expiryMonthField,"month",!0)):(e=(-1!=CC_GLOBAL.expiryYearField.selectedIndex?CC_GLOBAL.expiryYearField.options[CC_GLOBAL.expiryYearField.selectedIndex]:CC_GLOBAL.expiryYearField.options[0]).text,(-1!=CC_GLOBAL.expiryMonthField.selectedIndex?CC_GLOBAL.expiryMonthField.options[CC_GLOBAL.expiryMonthField.selectedIndex]:CC_GLOBAL.expiryMonthField.options[0]).text.substr(0,2)),a=CC_GLOBAL.cardNumberInput.value.replace(/ /g,""),r={"apiModeFields[firstname]":CC_GLOBAL.firstnameInput.value,"apiModeFields[lastname]":CC_GLOBAL.lastnameInput.value,"apiModeFields[number]":a,"apiModeFields[cvv]":CC_GLOBAL.cvvInput.value,"apiModeFields[expirationMonth]":t,"apiModeFields[expirationYear]":e,"apiModeFields[zip]":CC_GLOBAL.zipInput.value.replace(/ /g,"")};CREDIT_CARD_MODAL.apiRedirectPayload&&(r.request=CREDIT_CARD_MODAL.apiRedirectPayload);var i,n=new XMLHttpRequest,l="";for(i in r)""!=l&&(l+="&"),l+=i+"="+encodeURIComponent(r[i]);n.open("POST",CREDIT_CARD_MODAL.submitPaymentUrl,!0),n.responseType="text",n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),n.setRequestHeader("Access-Control-Allow-Origin",CREDIT_CARD_MODAL.domain),n.onreadystatechange=function(){var e,t,r={};4==n.readyState&&(e={httpResponseCode:r=n.response,joinPage:"undefined"!=typeof WIDGET_PREMIUM_SIGNUP&&WIDGET_PREMIUM_SIGNUP.joinPage?WIDGET_PREMIUM_SIGNUP.joinPage:"",apiRedirectPayload:CREDIT_CARD_MODAL.apiRedirectPayload,responseStatus:n.status,binTrackingNumber:a.substring(0,6)},""!==GLOBAL_PB_MONITORING.purchaseUUID&&"fanclub"===GLOBAL_PB_MONITORING.purchaseType&&(t=e,void 0!==GLOBAL_PB_MONITORING.purchaseUUID&&""!==GLOBAL_PB_MONITORING.purchaseUUID&&MG_Utils.ajaxCall({type:"POST",url:CREDIT_CARD_MODAL.probillerMonitoringFanclubApi,requestType:"text/json; charset=UTF-8",data:{pornhubUUID:GLOBAL_PB_MONITORING.purchaseUUID,httpResponseCode:t.responseStatus,apiRedirectPayload:t.apiRedirectPayload,joinPage:t.joinPage}})),e=e,CREDIT_CARD_MODAL.apiPornhubUUID&&MG_Utils.ajaxCall({type:"POST",url:CREDIT_CARD_MODAL.pbCallTrackingUrl,requestType:"text/json; charset=UTF-8",data:{pornhubUUID:CREDIT_CARD_MODAL.apiPornhubUUID,httpResponseCode:e.responseStatus,apiRedirectPayload:e.apiRedirectPayload,joinPage:e.joinPage,binTrackingNumber:e.binTrackingNumber}}),r&&"object"!=_typeof(r)?s(r):r&&r.responseText?s(r.responseText):CC_GLOBAL.paymentLoader&&MG_Utils.addClass(CC_GLOBAL.paymentLoader,"displayNone"))},n.send(l)}function n(e,t){t=void 0!==t?t:CC_GLOBAL.container.querySelector(".error_generalMessage"),e&&t&&(t.textContent=e,MG_Utils.addClass(t,"active"))}return{init:function(e,t){e=void 0!==e?e:document,cc_setGlobalVariables(e,t=void 0!==t?t:"v1"),creditCardListeners.init(CC_GLOBAL.version),"v1"==CC_GLOBAL.version&&(r=1==(a=(t=new Date).getMonth()+1).toString().length?"0"+a:a+"",CC_GLOBAL.expiryYearField&&(CC_GLOBAL.expiryYearField.value=t.getFullYear()),CC_GLOBAL.expiryMonthField&&(CC_GLOBAL.expiryMonthField.value=r+"-"+["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"][a-1]));var r=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),a=navigator.userAgent.match(/firefox/i);r&&MG_Utils.addClass(document.body,"safariDetected"),a&&MG_Utils.addClass(document.body,"firefoxDetected"),MG_Utils.addEventHandler(e,"click",function(e){!function(t){{var r,a,i,e,n;t.target&&"addBrazzers"===t.target.id&&(r="27923",a=CC_GLOBAL.container.querySelector(".submitPayment"),i=CC_GLOBAL.container.querySelector(".crossSellContainer"),e=window.location.search,n="",-1<e.indexOf("pp=")&&(e=e.substring(e.indexOf("pp=")+3),n=-1!=e.indexOf("&")?e.substring(0,e.indexOf("&")):e),void 0!==WIDGET_PREMIUM_SIGNUP.newUserProductId&&(r=WIDGET_PREMIUM_SIGNUP.newUserProductId),a&&i&&(MG_Utils.addClass(i,"disabledLoading"),t.target.setAttribute("disabled",!0),MG_Utils.addClass(a,"disabledLoading"),a.setAttribute("disabled",!0)),MG_Utils.ajaxCall({type:"POST",url:WIDGET_PREMIUM_SIGNUP.purchaseApiUrl,data:{user:t.target.value,isCrossSell:t.target.checked,productId:r,dbPackageId:n||0,joinPage:WIDGET_PREMIUM_SIGNUP.joinPage},success:function(e){e&&e[r]&&((e=e[r]).apiRedirectUrl&&(CREDIT_CARD_MODAL.submitPaymentUrl=e.apiRedirectUrl),e.apiPornhubUUID&&(CREDIT_CARD_MODAL.apiPornhubUUID=e.apiPornhubUUID),e.apiRedirectPayload&&(CREDIT_CARD_MODAL.apiRedirectPayload=e.apiRedirectPayload),a&&i&&(MG_Utils.removeClass(i,"disabledLoading"),t.target.removeAttribute("disabled",!0),MG_Utils.removeClass(a,"disabledLoading"),a.removeAttribute("disabled")))},error:function(){return CC_GLOBAL.container.querySelector("#addBrazzers").checked=!1}}))}}(e),function(e){if(e.target&&MG_Utils.hasClass(e.target,"submitPayment")){if(!CC_GLOBAL.expiryContainer||MG_Utils.hasClass(CC_GLOBAL.expiryContainer,"wrong")||MG_Utils.hasClass(CC_GLOBAL.expiryContainer,"correct")||creditCardValidationModule.checkExpiryDate(),6!=CC_GLOBAL.container.querySelectorAll(".floatContainer.correct").length)return creditCardValidationModule.validateAllFields();CC_GLOBAL.paymentLoader&&MG_Utils.removeClass(CC_GLOBAL.paymentLoader,"displayNone"),void 0!==CREDIT_CARD_MODAL.submitPaymentUrl&&CREDIT_CARD_MODAL.submitPaymentUrl&&!CREDIT_CARD_MODAL.alwaysGetProbillerApi?i():void 0!==CREDIT_CARD_MODAL.getProbillerApiUrl&&CREDIT_CARD_MODAL.getProbillerApiUrl&&function(){var e={apiMode:!0};void 0!==CREDIT_CARD_MODAL.getProbillerApiAjaxData&&CREDIT_CARD_MODAL.getProbillerApiAjaxData&&(e=MG_Utils.extendSimple(e,CREDIT_CARD_MODAL.getProbillerApiAjaxData));MG_Utils.ajaxCall({type:"POST",url:CREDIT_CARD_MODAL.getProbillerApiUrl,data:e,success:function(e){e.success&&"FAIL"!=e.success||void 0!==e.error&&!e.error?(CREDIT_CARD_MODAL.submitPaymentUrl=e.redirectUrl,"undefined"!=typeof purchaseFlow_Utils&&(void 0!==e.transactionId&&(purchaseFlow_Utils.trackingCreditCardParams.transactionId=e.transactionId),purchaseFlow_Utils.trackCreditCardModal(PF_CREDITCARDMODAL_TRACKING.trackingStatus.ccFormSubmit)),void 0!==e.pbMonitoring&&(GLOBAL_PB_MONITORING.purchaseType=e.pbMonitoring.type,GLOBAL_PB_MONITORING.purchaseUUID=e.pbMonitoring.uuid),i()):(CC_GLOBAL.paymentLoader&&MG_Utils.addClass(CC_GLOBAL.paymentLoader,"displayNone"),e.message&&n(e.message))},error:function(){CC_GLOBAL.paymentLoader&&MG_Utils.addClass(CC_GLOBAL.paymentLoader,"displayNone")}})}()}}(e)})},getCreditCardType:function(e){var t="none";return/^5/.test(e)?t="mastercard":/^4/.test(e)?t="visa":/^6/.test(e)?t="discover":/^352[89]|^35[3-8][0-9]/.test(e)?t="jcb":/^$/.test(e)&&(t="all"),t}}}(),creditCardValidationModule=function(){var i=new CreditCard;function n(e){for(var t=creditCardModule.getCreditCardType(e),r=CC_GLOBAL.container.querySelectorAll(".newUserPaymentWrapper .cardImgWrapper"),a=0;a<r.length;a++)"all"==t||"none"!=t&&MG_Utils.hasClass(r[a],t)?r[a].style.display="inline-block":r[a].style.display="none"}function l(e,t,r){var a,i=0,n=0,l=e.value;!1!==t&&(i=e.selectionStart,a=e.selectionEnd,r&&0<i&&" "==l[--i]&&i--,l=l.substring(0,i)+t+l.substring(a),n=i+t.length);for(var s=0,o=0,d="",C=[4,4,4,4],c=0;c<l.length&&(/\D/.test(l[c])?c<i&&n--:(s===C[o]&&(d+=" ",s=0,o++,c<=i&&n++),d+=l[c],s++,0),s!==C[o]||C.length!==o+1);c++);e.value=d,!1!==t&&e.setSelectionRange(n,n)}function s(e,t,r,a){t="v2"==CC_GLOBAL.version?closestElement(t,".floatContainer"):t.parentElement;(a=void 0!==a?a:"v2"==CC_GLOBAL.version?t.querySelector(".errorMessage"):t.nextElementSibling)&&("invalid"==e?(r&&(a.textContent=r),MG_Utils.addClass(t,"wrong"),MG_Utils.addClass(a,"active"),MG_Utils.removeClass(t,"correct")):"valid"==e?(r&&(a.textContent=r),MG_Utils.removeClass(t,"wrong"),MG_Utils.removeClass(a,"active"),MG_Utils.addClass(t,"correct")):"errTextOnly"==e&&(a.textContent=r))}return{onBlur:function(e){var t,r,a="v2"==CC_GLOBAL.version?closestElement(e,".floatContainer"):e.parentElement;e&&a?(t=CC_GLOBAL.container.querySelectorAll(".error_securityCode"),r="v2"==CC_GLOBAL.version?a.querySelector(".errorMessage"):a.nextElementSibling,0==e.value.length&&MG_Utils.removeClass(a,"active"),0<e.value.length?(MG_Utils.removeClass(a,"wrong"),MG_Utils.hasClass(a,"floatSecurityCode")?MG_Utils.removeClassMultiple(t,"active"):r&&MG_Utils.removeClass(r,"active")):(r&&MG_Utils.addClass(a,"wrong"),MG_Utils.hasClass(a,"floatSecurityCode")?MG_Utils.addClassMultiple(t,"active"):r&&MG_Utils.addClass(r,"active"),MG_Utils.removeClass(a,"correct"))):(r&&MG_Utils.addClass(a,"wrong"),r&&MG_Utils.addClass(r,"active"))},onFocus:function(e){(e="v2"==CC_GLOBAL.version?closestElement(e,".floatContainer"):e.parentElement)&&MG_Utils.addClass(e,"active")},onCCKeyDown:function(e){0<e.value.length&&(!event.keyCode||8===event.keyCode||46===event.keyCode)&&(event.preventDefault(),l(e,!!event.keyCode&&"",e.selectionStart===e.selectionEnd),n(e.value.replace(/ /g,"")))},onKeyPress:function(e){var t=new RegExp(/^[A-Z@~`!@#$%^&*()_=+\\\\';:\"\\/?>.<,-]*$/i),r="v2"==CC_GLOBAL.version?closestElement(e,".floatContainer"):e.parentElement,a="v2"==CC_GLOBAL.version?r.querySelector(".errorMessage"):r.nextElementSibling;if("Backspace"!=event.key&&13!==event.keyCode&&t.test(event.key))return a.textContent=CC_VALIDATION_MESSAGES.enterDigitsOnly,MG_Utils.addClass(r,"wrong"),MG_Utils.addClass(a,"active"),!1;if(8!==(a=event.charCode||event.keyCode||event.which)&&9!==a&&(a<37||40<a)&&(!event.ctrlKey||99!==a&&118!==a)){event.preventDefault();a=String.fromCharCode(a);if(/\D/.test(a))return!1;l(e,a)}n(e.value.replace(/ /g,""))},checkName:function(e,t){var r=new RegExp(/^[a-z\s-]{2,}$/i),a=3==t?CC_VALIDATION_MESSAGES.firstName:CC_VALIDATION_MESSAGES.lastName,i="v2"==CC_GLOBAL.version?e.parentElement.querySelector(".errorMessage"):e.parentElement.nextElementSibling;0!=e.value.length?e.value.length<t&&i?s("invalid",e,CC_VALIDATION_MESSAGES.validField+a+"!"):r.test(e.value)?s("valid",e,a+CC_VALIDATION_MESSAGES.required):s("invalid",e,CC_VALIDATION_MESSAGES.alphaOnly+a+"!"):s("errTextOnly",e,a+CC_VALIDATION_MESSAGES.required)},checkCreditCard:function(e){var t,r,a="v2"==CC_GLOBAL.version?closestElement(e,".floatContainer"):e.parentElement;l(e,!1),0!=e.value.length?null==(t=e.value.replace(/ /g,r="")).match(/^[0-9]+$/)?s("invalid",e,CC_VALIDATION_MESSAGES.enterDigitsOnly):!CREDIT_CARD_MODAL.allowVisaPaymentMethod&&"4"==t.substr(0,1)||!CREDIT_CARD_MODAL.allowMasterCardPaymentMethod&&"5"==t.substr(0,1)||!CREDIT_CARD_MODAL.allowDiscoverPaymentMethod&&"6"==t.substr(0,1)?s("invalid",e,CC_VALIDATION_MESSAGES.notAccepted):"2"!=t.substr(0,1)&&"3"!=t.substr(0,1)&&"4"!=t.substr(0,1)&&"5"!=t.substr(0,1)&&"6"!=t.substr(0,1)?s("invalid",e,CC_VALIDATION_MESSAGES.inValidCard):"34"==t.substr(0,2)||"37"==t.substr(0,2)?s("invalid",e,CC_VALIDATION_MESSAGES.noAmexCard):(t.length<12||19<t.length)&&!MG_Utils.hasClass(a,"wrong")?s("invalid",e,CC_VALIDATION_MESSAGES.cardNbrLength):!function(e){for(var t=e.length,r=t%2,a=0,i=t-1;0<=i;i--){var n=parseInt(e.charAt(i));i%2==r&&(n*=2),9<n&&(n-=9),a+=n}return a%10==0}(t)?s("invalid",e,CC_VALIDATION_MESSAGES.validCardNbr):(12<=t.length||t.length<=19)&&(r=i.getCreditCardNameByNumber(t),i.isValid(t)?"Visa"==r||"Discover"==r||"Mastercard"==r||"JCB"==r?MG_Utils.addClass(a,"correct"):s("invalid",e,CC_VALIDATION_MESSAGES.inValidCard):s("invalid",e,CC_VALIDATION_MESSAGES.validCardNbr)):(s("errTextOnly",e,CC_VALIDATION_MESSAGES.cardNbrReq),n(e.value.replace(/ /g,"")))},checkLength:function(e){0!=e.value.length?3!==e.value.length&&CC_GLOBAL.error_securityCodeElm?s("invalid",e,CC_VALIDATION_MESSAGES.validCVV,CC_GLOBAL.error_securityCodeElm):s("valid",e,CC_VALIDATION_MESSAGES.cvvReq,CC_GLOBAL.error_securityCodeElm):s("errTextOnly",e,CC_VALIDATION_MESSAGES.cvvReq,CC_GLOBAL.error_securityCodeElm)},checkExpiryDate:function(){var e,t=new Date,r=t.getMonth()+1,a=t.getFullYear(),i="v2"==CC_GLOBAL.version?(e=creditCardV2.getCleanedExpiryValue(CC_GLOBAL.expiryMonthField,"month"),creditCardV2.getCleanedExpiryValue(CC_GLOBAL.expiryYearField,"year")):(t=CC_GLOBAL.expiryMonthField&&-1!=CC_GLOBAL.expiryMonthField.selectedIndex?CC_GLOBAL.expiryMonthField.selectedIndex:0,i=CC_GLOBAL.expiryYearField&&-1!=CC_GLOBAL.expiryYearField.selectedIndex?CC_GLOBAL.expiryYearField.selectedIndex:0,e=CC_GLOBAL.expiryMonthField&&CC_GLOBAL.expiryMonthField.options&&CC_GLOBAL.expiryMonthField.options[t].text?parseInt(CC_GLOBAL.expiryMonthField.options[t].text.substr(0,2)):"",CC_GLOBAL.expiryYearField&&CC_GLOBAL.expiryYearField.options?parseInt(CC_GLOBAL.expiryYearField.options[i].text):"");""!==e&&""!==i?e<1||12<e||i<a||e<r&&a==i||a+9<i?s("invalid",CC_GLOBAL.expiryMonthField.parentElement,CC_VALIDATION_MESSAGES.expiryInvalid,CC_GLOBAL.error_expiryDateElm):(MG_Utils.removeClass(CC_GLOBAL.error_expiryDateElm,"active"),MG_Utils.removeClass(CC_GLOBAL.expiryContainer,"wrong"),MG_Utils.addClass(CC_GLOBAL.expiryContainer,"correct")):s("invalid",CC_GLOBAL.expiryMonthField.parentElement,CC_VALIDATION_MESSAGES.expiryReq,CC_GLOBAL.error_expiryDateElm)},checkZipCode:function(e){var t=new RegExp(/^[a-zA-Z0-9 ]+$/);0!=e.value.length?e.value.length<3||10<e.value.length||!t.test(e.value)?s("invalid",e,CC_VALIDATION_MESSAGES.invalidZipFormat):s("valid",e,CC_VALIDATION_MESSAGES.zipReq):s("errTextOnly",e,CC_VALIDATION_MESSAGES.zipReq)},validateAllFields:function(){for(var e=["cardNumber","securityCode","firstName","lastName","zipCode"],t=0;t<e.length;t++){var r=CC_GLOBAL.container.querySelector("."+e[t]),a=CC_GLOBAL.container.querySelector(".error_"+e[t]);r&&!r.value&&a&&(MG_Utils.addClass(r.parentElement,"wrong"),MG_Utils.addClass(a,"active"))}},checkMaxLength:function(e){var t=e.getAttribute("maxlength");e.value.length>t&&(e.value=e.value.slice(0,t))}}}(),creditCardListeners=function(){function e(e){e.target&&MG_Utils.hasClass(e.target,"secureInput")&&e.preventDefault()}function i(e){e=e.target;e&&(MG_Utils.hasClass(e,"floatFields")&&creditCardValidationModule.onBlur(e),MG_Utils.hasClass(e,"cardNumber")&&creditCardValidationModule.checkCreditCard(e),MG_Utils.hasClass(e,"securityCode")&&creditCardValidationModule.checkLength(e),(MG_Utils.hasClass(e,"firstName")||MG_Utils.hasClass(e,"lastName"))&&creditCardValidationModule.checkName(e,e.getAttribute("minLength")),MG_Utils.hasClass(e,"zipCode")&&creditCardValidationModule.checkZipCode(e))}function t(e){e.target&&(MG_Utils.hasClass(e.target,"expiryMonth")||MG_Utils.hasClass(e.target,"expiryYear"))&&creditCardValidationModule.checkExpiryDate()}return{init:function(){var r=CC_GLOBAL.form.querySelector(".newUserPaymentWrapper"),a=CC_GLOBAL.form.querySelector(".submitPayment");r&&(r.addEventListener("keypress",function(e){var t;e.target&&(t=e.target,MG_Utils.hasClass(t,"cardNumber")&&creditCardValidationModule.onKeyPress(t),MG_Utils.hasClass(t,"maxLenInput")&&!(window.getSelection()&&window.getSelection().anchorNode==t.parentElement)&&t.value.length>=Number(t.getAttribute("maxlength"))&&e.preventDefault())},!0),r.addEventListener("keydown",function(e){var t;e.target&&(MG_Utils.hasClass(e.target,"numInput")&&(t=e.keyCode||e.which,-1==[9,8,46,13,16,229].indexOf(t)&&(t<37||40<t)&&(t<48||57<t)&&(t<96||105<t)&&e.preventDefault()),MG_Utils.hasClass(e.target,"cardNumber")&&creditCardValidationModule.onCCKeyDown(e.target),MG_Utils.hasClass(e.target,"floatFields")&&13==e.keyCode&&(i(e),6==CC_GLOBAL.container.querySelectorAll(".floatContainer.correct").length&&a&&a.click()))},!0),r.addEventListener("input",function(e){e.target&&MG_Utils.hasClass(e.target,"cardNumber")&&creditCardValidationModule.onCCKeyDown(e.target)},!0),r.addEventListener("focus",function(e){e.target&&MG_Utils.hasClass(e.target,"floatFields")&&creditCardValidationModule.onFocus(e.target)},!0),r.addEventListener("blur",i,!0),r.addEventListener("copy",e,!0),r.addEventListener("paste",e,!0),r.addEventListener("cut",e,!0),"v1"==CC_GLOBAL.version?r.addEventListener("change",t,!0):"v2"==CC_GLOBAL.version&&(r.addEventListener("focusout",function(e){var t,r,a=e.target;a&&(MG_Utils.hasClass(a,"expiryMonth")||MG_Utils.hasClass(a,"expiryYear"))&&(r=e.relatedTarget,t=""==a.value,e=!!MG_Utils.hasClass(a,"expiryMonth")&&(!t&&r&&MG_Utils.hasClass(r,"expiryYear")),r=!!MG_Utils.hasClass(a,"expiryYear")&&(!t&&r&&MG_Utils.hasClass(r,"expiryMonth")),e||r||creditCardValidationModule.checkExpiryDate())},!0),r.addEventListener("input",function(e){var t=e.target;t&&MG_Utils.hasClass(t,"expiryMonth")&&(e=t.value,t=r.querySelector(".expiryYear"),2==e.length&&t&&t.focus())},!0)))}}}(),creditCardV2={getCleanedExpiryValue:function(e,t,r){r=void 0!==r&&r;var a="";return e&&""!==e.value&&(e=1==e.value.length?"0"+e.value:e.value,"month"==t?a=r?e:Number(e):"year"==t&&(a=r?"20"+e:Number("20"+e))),a},setPriceValues:function(e,t,r,a){r=void 0!==r?r:"",a=void 0!==a?a:"";var i,n=t.querySelector(".newUserPaymentWrapper");n&&(i=n.querySelector(".totalPrice .priceRight"),n=(t=n.querySelector(".savings")).querySelector(".priceRight"),"reset"==e&&(r=i?i.getAttribute("data-original"):"",a=n?n.getAttribute("data-original"):"",t&&MG_Utils.removeClass(t,"active")),i&&(i.innerText=r),t&&(n.innerText=a)&&MG_Utils.addClass(t,"active"))}};