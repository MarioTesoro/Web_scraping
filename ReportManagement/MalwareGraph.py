from matplotlib import pyplot as plt    #libreria per gestire un grafico
import pandas                           #libreria per creare un grafico partendo da un dictionary

#metodo che crea un grafico relativo a tipologia o famiglia di malware
def malware_graph(sorted_dict,url_splitted,from_):
    
    #viene creato un istogramma con i malware presenti in un sito
    #in base alla loro frequenta
    df = pandas.DataFrame.from_dict(sorted_dict, orient='index')
    df.plot(kind='bar', align='center')
    plt.title('Malware trovati')
    if(from_ == 'type'):
        plt.xlabel("Tipologie di malware")
        plt.ylabel("Frequenza")
        plt.legend(['frequenza tipologia'])
    else:
        plt.ylabel("Frequenza")
        plt.legend(['frequenza famiglia'])
    plt.xticks(rotation=10, horizontalalignment="center")
    file_name = f'graph_{url_splitted}.jpeg'
    plt.savefig(file_name)
    return file_name
